(function(b,f){if(b.TQE)return;var r="2.3.3",l=navigator.userAgent.toLowerCase(),a=b.document,e=!!b.ActiveXObject,g=e&&!b.XMLHttpRequest,m=l.indexOf("msie 9")>=0;isWebkit=l.indexOf("webkit")>=0,isOpera=l.indexOf("presto")>=0,isGecko=!isWebkit&&!isOpera&&l.indexOf("gecko")>=0,resStrCreateLink="\u6dfb\u52a0\u94fe\u63a5",resStrTargetOptions='<option value="">\u9ed8\u8ba4</option><option value="_blank">\u65b0\u7a97\u53e3</option><option value="_self">\u5f53\u524d\u7a97\u53e3</option><option value="_parent">\u7236\u7a97\u53e3</option><option value="_top">\u9876\u5c42\u7a97\u53e3</option>',resStrInsertLinkUI='\u7f51\u5740:<input type="text" id="url" value="" size=45 /><br />\u6807\u9898:<input type="text" id="title" value="" size=45 /><br />\u6253\u5f00:<select id="target">'+resStrTargetOptions+"</select>",resStrInsertImage="\u63d2\u5165\u56fe\u7247",resStrInsertImageUI='\u56fe\u7247\u7f51\u5740:<input type="text" id="url" value="" size=40 /><br />\u66ff\u6362\u6587\u672c:<input name="alt" type="text" id="alt" size="20" /><br />\u5c3a\u5bf8:<input name="width" type="text" id="width" size="4" /> &times; <input name="height" type="text" id="height" size="4" /> px &nbsp;<br />\u5bf9\u9f50:<select name="align" id="align"><option value="" >\u9ed8\u8ba4</option><option value="top">\u5c45\u4e0a</option><option value="textTop">\u6587\u672c\u4e0a\u65b9</option><option value="middle">\u5c45\u4e2d</option><option value="absMiddle">\u7edd\u5bf9\u5c45\u4e2d</option><option value="baseline">\u57fa\u7ebf</option><option value="bottom">\u5e95\u90e8</option><option value="absBottom">\u7edd\u5bf9\u5e95\u90e8</option><option value="left">\u5de6</option><option value="right">\u53f3</option></select> &nbsp; &nbsp; \u8fb9\u6846:<input name="border" type="text" id="border" size="5" />',resStrImageContextUI='<form class="ePopForm">\u7f51\u5740: <input type="text" id="url" size="50"><br>\u5c3a\u5bf8: <input  type="text" id="width" style="width:30px; overflow:visible;"> &times; <input  type="text" id="height" style="width:30px; overflow:visible;">px <a href="javascript:void(0)" id="resetWH" >\u91cd\u8bbe\u5927\u5c0f</a><label><input name="lock" type="checkbox" id="lock" value="1" checked>\u9501\u5b9a\u6bd4\u4f8b</label><br>\u66ff\u6362\u6587\u672c: <input type="text" id="alt" /> \u8fb9\u6846: <input type="text" id="border" style="width:30px; overflow:visible;" /><br>\u6392\u7248: <a href="javascript:void(0)" id="alignDefault">\u9ed8\u8ba4</a> | <a href="javascript:void(0)" id="alignLeft">\u5de6\u6d6e\u52a8</a> | <a href="javascript:void(0)" id="alignC">\u5c45\u4e2d</a> | <a href="javascript:void(0)" id="alignRight">\u53f3\u6d6e\u52a8</a> | <a href="javascript:void(0)" id="alignTop">\u4e0a\u5bf9\u9f50</a> | <a href="javascript:void(0)" id="alignAbsMiddle">\u4e2d\u5bf9\u9f50</a> | <a href="javascript:void(0)" id="alignBottom">\u4e0b\u5bf9\u9f50</a><div><hr>\u94fe\u63a5: <input type="text" id="link" size="40"><select id="target">'+resStrTargetOptions+"</select></div></form>",resStrInsertFlash="\u63d2\u5165\u52a8\u753b",resStrInsertFlashUI='Flash\u7f51\u5740:<input type="text" id="url" value="" size=40 /><br />\u5c3a\u5bf8:<input name="width" type="text" id="width" size="4" value="200" />&times;<input name="height" type="text" id="height" size="4" value="200" /> px',resStrInsertMusic="\u63d2\u5165\u97f3\u9891",resStrInsertMusicUI='\u97f3\u9891\u7f51\u5740:<input type="text" id="url" value="" size=40 /><br />\u81ea\u52a8\u64ad\u653e:<select id="auto_start" name="auto_start"><option value="0">\u624b\u52a8\u5f00\u59cb</option><option value="1">\u81ea\u52a8\u5f00\u59cb</option></select>',resStrInsertVideo="\u63d2\u5165\u89c6\u9891",resStrInsertVideoUI='\u89c6\u9891\u7f51\u5740:<input type="text" id="url" value="" size=40 /><br />\u5c3a\u5bf8:<input name="width" type="text" id="width" size="4"  value="320"/>&times;<input name="height" type="text" id="height" size="4" value="240" /> px<br />\u81ea\u52a8\u64ad\u653e:<select id="auto_start" name="auto_start"><option value="0">\u624b\u52a8\u5f00\u59cb</option><option value="1">\u81ea\u52a8\u5f00\u59cb</option></select><br />\u89c6\u9891\u7c7b\u578b:<select id="video_type" name="video_type"><option value="auto">\u81ea\u52a8\u8bc6\u522b</option><option value="flv">FLV</option><option value="rm">RMVB</option><option value="wm">\u5176\u4ed6\u89c6\u9891</option></select>',resStrInsertRow="\u63d2\u5165\u884c",resStrInsertCol="\u63d2\u5165\u5217",resStrDeleteRow="\u5220\u9664\u884c",resStrDeleteCol="\u5220\u9664\u5217",resStrDeleteTable="\u5220\u9664\u8868\u683c",resStrTableContextUI='<div><a class="eMenuItem" style="width:168px;" ><span id="eMergeCells" class="eButton"></span>\u5408\u5e76\u5355\u5143\u683c</a><a style="width:168px;" class="eMenuItem" ><span id="eSplitCells" class="eButton"></span>\u62c6\u5206\u5355\u5143\u683c</a><hr width="166"><div style="padding:1px 1px 1px 3px;">\u8868\u683c\u6392\u7248: <a id="eTableAlignLeft">\u5c45\u5de6</a> | <a id="eTableAlignCenter">\u5c45\u4e2d</a> | <a id="eTableAlignRight">\u5c45\u53f3</a></div><table border="0" cellSpacing="2" cellPadding="0"><tbody><tr><td width="65" align="center" valign="top" bgcolor="#FFFFFF" style="border:#999 solid 1px;">\u5185\u5bb9\u5bf9\u9f50<br><a id="eCellAlignLT" class="eButton eCellAlign"></a><a id="eCellAlignCT" class="eButton eCellAlign"></a><a id="eCellAlignRT" class="eButton eCellAlign"></a><br><a id="eCellAlignLC" class="eButton eCellAlign"></a><a id="eCellAlignCC" class="eButton eCellAlign"></a><a id="eCellAlignRC" class="eButton eCellAlign"></a><br><a id="eCellAlignLB" class="eButton eCellAlign"></a><a id="eCellAlignCB" class="eButton eCellAlign"></a><a id="eCellAlignRB" class="eButton eCellAlign"></a></td><td width="90" align="center" valign="top">\u5bbd\u5ea6<input id="width" name="width" size="3" type="text"><br>\u8fb9\u6846<input id="border" name="border" size="3" type="text"><br>\u95f4\u8ddd<input id="cellSpacing" name="cellSpacing" size="3" type="text"><br>\u586b\u5145<input id="cellPadding" name="cellPadding" size="3" type="text"></td></tr></tbody></table></div><div><hr width="166">\u63d2\u5165\u8868\u683c</div>',resStrNoColor="\u65e0\u8272",resStrOK="\u786e\u5b9a",resStrCenal="\u53d6\u6d88",resStrUpload="\u4e0a\u4f20",resStrClose="\u5173\u95ed",resStrVersion="\u7248\u672c",resStrAuthor="\u4f5c\u8005",resStrSite="\u5b98\u7f51",resStrMail="\u90ae\u7bb1",resStrPageTitlePre="\u5206\u9875\u6807\u9898: ",TQE=function(q,k){var j=this,l=TQE.clone(TQE.config);j.objId=q;if(k){if(k.height&&k.height!="auto"){k.height=parseInt(k.height);if(isNaN(k.height))k.height="auto"}for(var r in k)l[r]=k[r]}if(typeof l.toolbar=="string"){var n=TQE.toolbarMode[l.toolbar];if(!n)n=TQE.toolbarMode.normal;l.toolbar=n.left;if(!k||f===k.toolbarRight)l.toolbarRight=n.right}j.config=l;j.hasFocus=false;j._containerDiv=null;j._toolbarDiv=null;j._clientDiv=null;j._statusDiv=null;j.init=function(){j.obj=TQE.find(j.objId);if(!j.obj){if(j.config.debug)throw"\u7f3a\u5c11ID\u4e3a "+j.objId+" \u8868\u5355\u5143\u7d20";return}if(j.obj.editor)return;j.obj.editor=j;if(!j.config.width||j.config.width=="auto")if(j.obj.style.width)j.config.width=j.obj.style.width;else if(j.obj.cols)j.config.width=j.obj.cols*8+"px";else j.config.width="100%";if(!j.config.height||j.config.height=="auto")if(j.obj.style.height)j.config.height=parseInt(j.obj.style.height,10);else if(j.obj.offsetHeight)j.config.height=j.obj.offsetHeight;else if(j.obj.rows)j.config.height=j.obj.rows*17;else j.config.height=200;var f,g,d,c='<div class="" id="'+j.objId+'_EditorToolBar">';c+='</div><div id="'+j.objId+'_EditorClient" class="eEditorClient"><iframe id="'+j.objId+'_Editor" style="height:'+j.config.height+'px;" frameborder=0 ></iframe></div><div class="eStatusBar"><div class="eResizeWH" ></div><div class="eResizeH" ></div></div>';if(!j.config.debug)j.obj.style.display="none";var a=TQE.CE("DIV","TQEditorContainer_"+j.objId,c);a.className="eEditor";a.style.width=j.config.width;j.obj.parentNode.insertBefore(a,j.obj);j._containerDiv=a;j._toolbarDiv=TQE.find(j.objId+"_EditorToolBar");j._clientDiv=TQE.find(j.objId+"_EditorClient");"function"===typeof j.config.oninit&&j.config.oninit.call(j);j._initContent(j.obj.value);j.changeToolbarMode(j.config.advToolbarMode,true);j.obj.focus=function(){this.editor.focus()};j._statusDiv=a.lastChild;if(false==j.config.resize)j._statusDiv.style.display="none";j._statusDiv.onmousedown=function(c){var h,i,g,m,f=this,a=TQE.pos(this),l=TQE._docST(),k=TQE._docSL(),n=j.config.height,o=j._containerDiv.offsetWidth-2,d=this.style.cursor=="se-resize",r=TQE.pos(j._clientDiv).y;j._showTableContext(0);if(e){c=b.event;g=c.srcElement;h=k+c.clientX-a.x;i=l+c.clientY-a.y}else{g=c.target;h=c.pageX-a.x;i=c.pageY-a.y}d=d||g===f.firstChild&&"h"!=j.config.resize;f.mouseout=f.onmouseleave=null;var p=function(c){if(e){c=b.event;c.pageX=k+c.clientX;c.pageY=l+c.clientY}var f=r-TQE.pos(j._clientDiv).y,m=Math.max(50-n+a.y-f,c.pageY-i),g=Math.max(100-o+a.x,c.pageX-h);d&&j.setWidth(g-a.x+o);j.setHeight(m-a.y+n+f)},q=function(){j.focus();j._popTableContext()};m=TQE._draging(p,q,f);m.style.cursor=d?"se-resize":"s-resize"}};j._toobarCode=function(e,c){var b,d,a="";if(c.length){a+='<span class="eToolBarGroupRight" >';for(b=0;b<c.length;b++)a+=j._btnCode(c[b],false);a+="</span>"}a+='<span class="eToolBarGroup" >';if(j.config.showToolbarGroupHandle){d=TQE.toolbarBottons.group;a+='<div class="eButton eFirstToolBarGroup" id="eBTNgroup"  style="background-position: -'+d.left+"px 0;width:"+d.width+'px;" ></div>'}for(b=0;b<e.length;b++)a+=j._btnCode(e[b],true);a+='</span><div class="eClear"></div>';return a};j._btnCode=function(a,f){var e="",b,d,c;if("||"===a)a="group";else if("|"===a)a="separator";else if("string"!==typeof a){e='submenu="'+a.join(",")+'" ';a="submenu"}b=TQE.toolbarBottons[a];if(!b)return"";c=function(b){return'id="eBTN'+a+'" class="eButton"'+(b.css?' style="'+b.css+'"':"")};switch(a){case"group":if(!f)return"";d='</span><span class="eToolBarGroup" >';if(j.config.showToolbarGroupHandle)d+="<div "+c(b)+" ></div>";return d;case"separator":return"<div "+c(b)+" ></div>";case"br":return"<br />";default:return'<a href="javascript:void(0)" name="'+a+'" title="'+b.text+'" '+e+c(b)+" >"+b.text+"</a>"}};j._ieMouseStyle=function(b,d,c,f){if(!e||!g&&a.compatMode=="CSS1Compat")return;TQE.addListener(b,"mouseover",function(){this.className=c});TQE.addListener(b,"mouseup",function(){this.className=c});TQE.addListener(b,"mousedown",function(){this.className=f});TQE.addListener(b,"mouseout",function(){this.className=d})};j._keepBookmark=function(){if(e){var a,b=TQE.find(j.objId+"_Editor");TQE.addListener(b,"beforedeactivate",function(){a=j._getRange()});TQE.addListener(b,"activate",function(){if(null==a)return;var b=j._getSelection();if(b.addRange)b.addRange(a);else a.select();a=null})}};j._toolbarBottonClick=function(){var c=e?event:arguments[0],b=this.getAttribute("name"),a=TQE.toolbarBottons[b];c.cancelBubble=true;j.focus();if(a&&a.click)a.click(j,this);else{TQE.hidePop();j.exeCmd(b)}};j.__selectOption=function(b,c){for(var a=b.options.length-1;a>=0;a--)if(b.options[a].value==c){b.selectedIndex=a;return}};j.exeCmd=function(a,d){j.focus();var f=j.selectedCells(),c=j._getDoc(),b=j._getSelection(),e,g,h;if(f.length){g=c.createRange?c.createRange():c.body.createTextRange();for(e=0;e<f.length;e++){if("backcolor"==a||"hilitecolor"==a){f[e].style.backgroundColor=d;continue}if(b.empty)b.empty();else b.removeAllRanges&&b.removeAllRanges();if(b.selectAllChildren)b.selectAllChildren(f[e]);else if(g.moveToElementText){g.moveToElementText(f[e]);g.select()}try{c.execCommand(a,false,d!=null?d:false);if("bold"==a||"italic"==a||"underline"==a||"strikethrough"==a||"subscript"==a||"superscript"==a)if(e==0)h=c.queryCommandState(a);else h!=c.queryCommandState(a)&&c.execCommand(a,false,d!=null?d:false)}catch(i){}}if(b.empty)b.empty();else b.removeAllRanges&&b.removeAllRanges()}else try{return c.execCommand(a,false,d!=null?d:false)}catch(i){}};j.focus=function(){if(j.hasFocus)return;if("visual"==j.currentMode()){var c=j.selectedCells(),a,b;if(c.length<1){j._editorObj().contentWindow.focus();var a=j._getRange(),b=j._getSelection();if(isWebkit&&b.rangeCount<1){a.selectNodeContents(j._getDoc().body);a.collapse(true);b.removeAllRanges();b.addRange(a)}}else{var a=j._getRange();if(a.select){a.collapse(false);a.select()}else{a.selectNodeContents(c[0]);a.collapse(false);b=j._getSelection();b.removeAllRanges();b.addRange(a)}}}else j._editorObj().focus();j.hasFocus=true};j.focusNode=function(){if("visual"!==j.currentMode()||!j.hasFocus)return null;var a,b=j._getSelection().focusNode;if(!b){a=j._getRange();return a.length?a.item(0).parentNode:a.parentElement?a.parentElement():null}return b};j._showColorSelectUI=function(d,c){var a=TQE.find(j.objId+"ColorSelect"+c);if(null==a){a=TQE.CE("DIV",j.objId+"ColorSelect"+c,TQE._colorPickerUI(),true);a.className="ePopPanel";TQE._noSel(a);TQE.listenTags(a,"TD","click",function(){TQE.hidePop();j.exeCmd(c,this.bgColor)});a.lastChild.lastChild.onclick=function(){TQE.hidePop();j.exeCmd(c,"")};TQE.listenTags(a,"TD","mouseover",function(){var a=this,d=b.setInterval(function(){a.style.backgroundColor=a.style.backgroundColor!=""?"":"#FFFFFF"},500),c=this.parentNode.parentNode.parentNode.parentNode.lastChild;c.firstChild.style.backgroundColor=this.bgColor;c.firstChild.nextSibling.innerHTML=this.bgColor;this.style.backgroundColor="#FFFFFF";this.onmouseout=function(){b.clearInterval(d);this.style.backgroundColor=""}})}TQE.pop(a,d)};j._popAsMenu=function(h,i){var k=h.getAttribute("name"),a=TQE.find(j.objId+"PopMenu"+k),f="",e,b,c,d;if(null==a){a=TQE.CE("DIV",j.objId+"PopMenu"+k,"",true);a.className="ePopPanel"}for(b=0;b<i.length;b++){c=i[b];if("separator"==c||"|"==c){f+='<hr style="width:120px; clear:both;" />';continue}d=TQE.toolbarBottons[c];if(d)f+='<div  name="'+c+'" class="eMenuItem" ><span class="eButton" id="eBTN'+c+'" ></span>'+d.text+"</div>"}a.innerHTML=f;TQE._noSel(a);isOpera&&TQE._noSel(a,"DIV");TQE.listenTags(a,"DIV","click",j._toolbarBottonClick);if(g){e=TQE._tags(a,"DIV");for(b=e.length-1;b>=0;b--)j._ieMouseStyle(e[b],"eMenuItem","eMenuItemUp","eMenuItem")}TQE.pop(a,h)};j._popFormUI=function(s,p,r,q,d,a,m,n,o){var b='<form class="ePopForm">';if(a){b+='<div class="eTabBar"><a href="javascript:void(0)" class="active" HIDEFOCUS="true">'+p+'</a><a href="javascript:void(0)" HIDEFOCUS="true">'+resStrUpload+"</a></div>";b+="<div>"}b+=r;b+='<div class="eBar"><button id="OK" name="OK" type="submit" class="eBtn"  HIDEFOCUS="true"/>'+resStrOK+'</button> &nbsp; <button id="Cancel" name="Cancel" type="button" class="eBtn"  HIDEFOCUS="true">'+resStrCenal+"</button></div>";if(a){b+='</div><div style="display:none">';var e=a;if(a.substr(0,1)=="#")e=a.substring(1);else{if(!("http://"==a.substr(0,7).toLowerCase()||"/"==a.substr(0,1)||"https://"==a.substr(0,6).toLowerCase()))if("?"==a.substr(0,1))a=location.pathname+a;else{var g=location.pathname.split("/");g[g.length-1]=a;a=g.join("/")}e=TQE.url+"upload.htm?url="+encodeURIComponent(a)+"&field_name="+j.config.uploadFieldName+"&exts="+encodeURIComponent(m)+"&max_size="+encodeURIComponent(n)+"&debug="+j.config.debug+"&upload_type="+o}b+='<iframe src="'+e+'" frameborder=0 width=358 height=45 ALLOWTRANSPARENCY=true marginwidth=0 marginheight=0 ></iframe>';b+="</div>"}b+="</form>";var c=TQE.CE("DIV",s,b,true);c.className="ePopPanel";if(a){var k=function(){this.className="active";var a=this.parentNode.nextSibling;if(this.nextSibling){this.nextSibling.className="";a.style.display="";a.nextSibling.style.display="none";a.parentNode.getElementsByTagName("INPUT")[0].focus()}else if(this.previousSibling){this.previousSibling.className="";a.style.display="none";a.nextSibling.style.display=""}},l=c.firstChild.firstChild;l.firstChild.onclick=k;l.lastChild.onclick=k}var h=TQE._tags(c,"FORM")[0],f=h.elements;h.srcEditor=j;f.Cancel.onclick=TQE.hidePop;f.OK.onclick=q;h.onsubmit=function(){this.elements.OK.click();return false};if(d)for(i=d.length-1;i>=0;i--)j._intEdit(f[d[i]]);TQE._noSel(c);isOpera&&TQE._noSel(c,"FORM,DIV");return c};j.insertMusic=function(b,a){var c=j.config.tplMusic.replace(/\{\$url\}/g,b).replace(/\{\$auto_start\}/g,a);j.insertHtml(c)};j.insertFlash=function(d,c,b){var a=j.config.tplFlash.replace(/\{\$url\}/g,d);a=a.replace(/\{\$width\}/g,c);a=a.replace(/\{\$height\}/g,b);j.insertHtml(a)};j.insertVideo=function(c,d,g,f,e){var a="",b;switch(e){case"rm":a=j.config.tplRm;break;case"flv":a=j.config.tplFlv;break;case"wm":a=j.config.tplVideo;break;default:b=c.substr(c.lastIndexOf(".")).toLowerCase();if(".flv"==b)a=j.config.tplFlv;else if(".rm"==b||".rmvb"==b)a=j.config.tplRm;else a=j.config.tplVideo}a=a.replace(/\{\$url\}/g,c).replace(/\{\$auto_start\}/g,d).replace(/\{\$width\}/g,g).replace(/\{\$height\}/g,f);j.insertHtml(a)};j.insertHtml=function(d,c){j.focus();if("code"==j.currentMode()){var e=j._editorObj();if(a.selection){var b=a.selection.createRange();if("before"==c||-1==c)b.text=d+b.text;else if("after"==c||1==c)b.text+=d;else b.text=d;b.select()}else if(e.selectionStart||e.selectionStart=="0"){var i=e.selectionStart,k=e.selectionEnd,n=e.scrollTop,g=e.value;if("before"==c||-1==c)d=g.substring(i,k)+d;else if("after"==c||1==c)d+=g.substring(i,k);e.value=g.substr(0,i)+d+g.substr(k,g.length);e.focus();e.selectionStart=e.selectionEnd=i+d.length;e.scrollTop=n}else{e.value+=d;e.focus()}j.save();return}if(isGecko)d=d.replace(/<td([^>]*)>\s*<\/td/ig,"<td$1 ><br></td");var b=j._getRange();if(b.length){var o=j._getDoc(),p=b.item(0),h=o.body.createTextRange();h.moveToElementText(p);if("before"==c||-1==c)h.collapse();else if("after"==c||1==c)h.collapse(false);else b.execCommand("Delete");h.pasteHTML(d);h.select()}else if(b.insertNode){var f,m,l;if(b.createContextualFragment)f=b.createContextualFragment(d);else{f=j._getDoc().createDocumentFragment();f.appendChild(TQE.CE("div"));f.firstChild.outerHTML=d}if("before"==c||-1==c){m=f.lastChild;b.insertNode(f);b.setEndAfter(m)}else if("after"==c||1==c){b.collapse(false);b.insertNode(f)}else{b.deleteContents();b.insertNode(f)}b.collapse(false);l=j._getSelection();l.removeAllRanges();l.addRange(b)}else{if("before"==c||-1==c)b.collapse(true);else("after"==c||1==c)&&b.collapse(false);b.pasteHTML(d);b.collapse(false);b.select()}j.save()};j.appendHtml=function(a){j.unselectAllCells();j.setContent(j.content()+a)};j._editorObj=function(){return TQE.find(j.objId+"_Editor")};j.currentMode=function(){return j._editorObj().tagName.toUpperCase()==="IFRAME"?"visual":"code"};j._getDoc=function(){var a=j._editorObj();return a.contentDocument||a.contentWindow.document};j._getSelection=function(){var a=j._editorObj().contentWindow;return a.getSelection?a.getSelection():j._getDoc().selection};j._getRange=function(){var a=j._getSelection(),c=j._getDoc(),b;try{b=a.rangeCount>0?a.getRangeAt(0):a.createRange?a.createRange():c.createRange()}catch(d){}if(!b)b=e?c.body.createTextRange():c.createRange();return b};j.insertImage=function(h,c,b,d,g,e){if(""==h)return;var a='<img src="'+h+'" ';if(c!==f&&""!=c&&!isNaN(parseInt(c))&&parseInt(c)>0)a+=" width="+parseInt(c);if(b!==f&&""!=b&&!isNaN(parseInt(b))&&parseInt(b)>0)a+=" height="+parseInt(b);if(d!==f&&""!=d&&!isNaN(parseInt(d)))a+=" border="+parseInt(d);if(g!==f&&""!=g)a+=' alt="'+g+'"';if(e!==f&&""!=e)a+=' align="'+e+'"';a+=" />";j.insertHtml(a);return};j._enableButton=function(a,b){if(a.disabled===f)a.disabled=false;if(a.disabled!=b)return;if(b){a.disabled=false;j.setOpacity(a,100);TQE.addListener(a,"click",j._toolbarBottonClick)}else{a.disabled=true;j.setOpacity(a,30);TQE.delListener(a,"click",j._toolbarBottonClick)}};j._updateToolbar=function(f,e,d){var g=j._toolbarDiv,c=j._button("mode"),b=TQE._tags(g,"A"),a;if(c)c.id="visual"===j.currentMode()?"eBTNmode":"eBTNmode-reset";for(a=b.length-1;a>=0;a--)j.inArray(b[a].getAttribute("name"),e)^d&&j._enableButton(b[a],f)};j._hook=function(){var b=j._getDoc();b.onkeydown=function(g){TQE._hideContext();if(e)g=j._realEvent(g);var h=g.keyCode||g.which;g.ctrlKey&&(13==h||10==h||83==h)&&j.save();var n=j._call("keydown",g);if(f!==n&&false==n)return false;(8==h||46==h)&&j.selectedCells().length&&j.exeCmd("delete");if(h==13){var b=j.focusNode(),l,i,d,m;if(!b)return;if(b.nodeName==="#text")b=b.parentNode;if(b.className=="splitPage"){l=b.parentNode;if(b.nextSibling&&b.nextSibling.nodeName==="BR")i=b.nextSibling;else{i=a.createElement("BR");if(l.lastChild==b)l.appendChild(i);else l.insertBefore(i,b.nextSibling)}m=j._getDoc();if(e){d=m.body.createTextRange();d.moveToElementText(i);d.collapse(true);d.select()}else{d=m.createRange();d.selectNode(i);d.collapse(true);var o=j._getSelection();o.removeAllRanges();o.addRange(d)}return false}if(j.config.enter2br){if(b.tagName!="LI"){j.insertHtml("<br />");return false}}else if(!e&&!g.shiftKey){for(var n=j._getRange(),c,k=n.startContainer;k;k=k.parentNode){c=k.nodeName;if(c=="LI"||c=="P"||"H1"==c||"H2"==c||"H3"==c||"H4"==c||"H5"==c||"H6"==c||"DIV"==c)return true}j.exeCmd("FormatBlock","p")}}};b.onkeyup=function(c){c=j._realEvent(c);var e=c.keyCode||c.which,d=this.body.firstChild;if((8===e||46===e)&&d&&d===b.body.lastChild){var a=d.nodeName,f=d.innerHTML,g=/^<(strong|em|b|i|u|font)[^>]*><\/\1>|&nbsp;$/i;if(a==="P"||a==="H1"||a==="H2"||a==="H3"||a==="H4"||a==="H5"||a==="H6"||a==="BR")if(""===f||g.test(f))b.body.innerHTML=""}j._call("keyup",c)};b.ondragstart=function(){TQE._hideContext();j._showTableContext(0)};b.onclick=function(b){var a,d,c;TQE._hideContext();if(!e){a=b.target;if("IMG"===a.nodeName){d=j._getDoc().createRange();c=j._getSelection();d.selectNode(b.target);c.removeAllRanges();c.addRange(d);j._popImagePanel(a)}}else{b=j._realEvent(b);a=b.srcElement;"IMG"===a.nodeName&&j._popImagePanel(a)}};if(e){b.onmousedown=b.onclick;b.onclick=null}b.body.onpaste=function(a){if(e)a=j._realEvent(a);var b=j._call("paste",a);j.config.autoClean&&setTimeout(j.cleanWord,200)};TQE.addListener(b,"mouseup",TQE.hidePop);TQE.addListener(b,"scroll",j._popTableContext);TQE.addListener(b.body,"scroll",j._popTableContext);TQE.addListener(b,"keyup",j._popTableContext);TQE.addListener(b,"mouseup",j._popTableContext);TQE.addListener(b,"mousedown",j._startSelectTd);TQE.addListener(b,"keypress",j.unselectAllCells);if(g){TQE.addListener(b,"mouseup",j.focus);TQE.addListener(b,"mousedown",j.focus)}};j._popImagePanel=function(b){if(!j.config.autoPopImagePanel)return;var a=TQE.find("__tqImagePanel");if(null==a){a=TQE.CE("DIV","__tqImagePanel",resStrImageContextUI,true);a.className="ePopPanel";var i=TQE._tags(a,"FORM")[0],c=i.elements;j._intEdit(c.width);j._intEdit(c.height);j._intEdit(c.border);a.urlField=c.url;a.widthField=c.width;a.heightField=c.height;a.lockField=c.lock;a.borderField=c.border;a.altField=c.alt;a.linkField=c.link;a.targetField=c.target;a.linkField.onchange=function(){var c=this.parentNode.parentNode.parentNode,b=c.target,a=b.parentNode;if(a.nodeName!=="A")return;a.setAttribute("href",this.value)};a.targetField.onchange=function(){var c=this.parentNode.parentNode.parentNode,b=c.target,a=b.parentNode;if(a.nodeName!=="A")return;a.setAttribute("target",this.options[this.selectedIndex].value)};a.urlField.onchange=function(){this.parentNode.parentNode.target.src=this.value};a.urlField.onfocus=function(){this.select()};var g=function(){var a=this.parentNode.parentNode,b=a.target,c=h=Math.max(1,this.value);if(a.lockField.checked)if(this.id=="width")h=a.heightField.value=Math.round(c/a.rate);else c=a.widthField.value=Math.round(h*a.rate);else if(this.id=="width")h=a.heightField.value;else c=a.widthField.value;b.width=c;b.height=h;b.style.width="";b.style.height=""};a.widthField.onchange=a.widthField.onblur=a.heightField.onchange=a.heightField.onblur=g;a.borderField.onchange=function(){var a=this.parentNode.parentNode.target;if(""===this.value)a.removeAttribute("border");else a.border=this.value};a.altField.onchange=function(){var a=this.parentNode.parentNode.target;if(""===this.value)a.removeAttribute("alt");else a.alt=this.value};a.lockField.onclick=function(){if(this.checked){var a=this.parentNode.parentNode.parentNode;a.rate=a.widthField.value/a.heightField.value}};for(var f=function(){var c=this.parentNode.parentNode,a=c.target,b=this.id;if("resetWH"==b){a.removeAttribute("width");a.removeAttribute("height");a.style.width="";a.style.height="";c.widthField.value=a.width;c.heightField.value=a.height;c.rate=a.width/a.height}else{a.align="";a.style.display="";a.style.margin="";j.exeCmd("justifynone");if("alignC"==b)j.exeCmd("justifycenter");else if("alignDefault"!=b)a.align=b.substring(5,20).toLowerCase()}return false},e=TQE._tags(a,"A"),d=e.length-1;d>=0;d--)e[d].onclick=f;TQE._noSel(a)}if(b.parentNode&&b.parentNode.nodeName==="A"){a.lastChild.lastChild.style.display="";a.linkField.value=b.parentNode.getAttribute("href");j.__selectOption(a.targetField,b.parentNode.getAttribute("target"))}else{a.lastChild.lastChild.style.display="none";a.linkField.value="";a.targetField.selectedIndex=0}a.target=b;a.urlField.value=b.getAttribute("src");a.widthField.value=b.width;a.heightField.value=b.height;a.borderField.value=b.border;a.altField.value=b.alt;a.rate=b.width>0&&b.height>0?b.width/b.height:1;j._popContext(a,b)};j._popContext=function(a,f){TQE.activeContext!=a&&TQE._hideContext();var e,b,c;p=TQE.pos(j._editorObj()),p2=f.getBoundingClientRect(),d=TQE._doc();a.style.display="block";e=Math.min(p.x+p2.left,TQE._docSL()+d.clientWidth-a.offsetWidth-5);b=Math.min(p.y+p.height,10+p.y+p2.bottom);c=TQE._docST()+d.clientHeight-a.offsetHeight-10;if(b>c)b=Math.max(p.y-a.offsetHeight,p.y+p2.top-a.offsetHeight-10);a.style.left=e+"px";a.style.top=b+"px";TQE.activeContext=a;TQE.drag(a)};j._showTableContext=function(d){for(var a,c=["TQEAddRowBefore","TQEAddRowAfter","TQEAddColBefore","TQEAddColAfter","TQEDeleteRow","TQEDeleteColumn","TQEDeleteTable"],b=c.length;b>=0;b--){a=TQE.find(c[b]);if(a)a.style.display=d?"":"none"}};j._popTableContext=function(){if(!j.config.autoPopTablePanel)return;var l,a=j.focusNode();while(a&&a.nodeName!=="TD")a=a.parentNode;if(!a)return j._showTableContext(0);l=a.parentNode.parentNode.parentNode;var k=TQE.pos(j._editorObj()),o=l.getBoundingClientRect(),d=a.getBoundingClientRect(),b=TQE.find("TQEAddRowBefore"),g=TQE.find("TQEAddRowAfter"),e=TQE.find("TQEAddColBefore"),c=TQE.find("TQEAddColAfter"),i=TQE.find("TQEDeleteRow"),f=TQE.find("TQEDeleteColumn"),h=TQE.find("TQEDeleteTable"),p=j._getDoc().documentElement,m,n;if(d.top+a.offsetHeight<0||d.left+a.offsetWidth<0||d.top>=p.clientHeight||d.left>=p.clientWidth)return j._showTableContext(0);if(!b){h=TQE.CE("A","TQEDeleteTable","",true);h.title=resStrDeleteTable;b=TQE.CE("A","TQEAddRowBefore","",true);g=TQE.CE("A","TQEAddRowAfter","",true);g.className=b.className="eButtonAddRow";b.title=g.title=resStrInsertRow;e=TQE.CE("A","TQEAddColBefore","",true);c=TQE.CE("A","TQEAddColAfter","",true);c.className=e.className="eButtonAddCol";e.title=c.title=resStrInsertCol;i=TQE.CE("A","TQEDeleteRow","",true);f=TQE.CE("A","TQEDeleteColumn","",true);f.className=i.className=h.className="eButtonDeleteRC";i.title=resStrDeleteRow;f.title=resStrDeleteCol;TQE._noSel(b);TQE._noSel(g);TQE._noSel(e);TQE._noSel(c);TQE._noSel(i);TQE._noSel(f);TQE._noSel(h);b.onclick=g.onclick=e.onclick=c.onclick=i.onclick=f.onclick=h.onclick=function(){if(!this.cell)return;var a=this.cell,c=a.parentNode.parentNode.parentNode,b=this.editor;b.unselectAllCells();switch(this.id){case"TQEAddRowBefore":TQE.insertRow(a,1);break;case"TQEAddRowAfter":TQE.insertRow(a,0);break;case"TQEAddColBefore":TQE.insertCol(a,1);break;case"TQEAddColAfter":TQE.insertCol(a,0);break;case"TQEDeleteRow":TQE.deleteRow(a);break;case"TQEDeleteColumn":TQE.deleteCol(a);break;case"TQEDeleteTable":c.parentNode.removeChild(c)}b.focus();b._popTableContext()}}else j._showTableContext(1);b.cell=g.cell=e.cell=c.cell=i.cell=f.cell=h.cell=a;b.editor=g.editor=e.editor=c.editor=i.editor=f.editor=h.editor=j;g.style.left=b.style.left=i.style.left=Math.min(k.x+j._getDoc().body.offsetWidth-12,k.x+o.left+l.offsetWidth)+"px";b.style.top=k.y+d.top-5+"px";g.style.top=k.y+d.top+a.offsetHeight-4+"px";i.style.top=k.y+d.top+(a.offsetHeight>>>1)-6+"px";c.style.top=e.style.top=f.style.top=k.y+Math.max(0,o.top-12)+"px";e.style.left=k.x+d.left-5+"px";c.style.left=k.x+d.left+a.offsetWidth-5+"px";f.style.left=k.x+d.left+(a.offsetWidth>>1)-6+"px";m=TQE.pos(b);n=TQE.pos(c);h.style.top=Math.min(n.y,m.y-13)+"px";h.style.left=Math.max(n.x+10,m.x)+"px"};j.activeTable=null;j.unselectAllCells=function(){if(!j.activeTable)return;try{for(var c=j.activeTable,b,a=c.rows.length-1;a>=0;a--)for(b=c.rows[a].cells.length-1;b>=0;b--){td=c.rows[a].cells[b];p=TQE.pos(td);j._selectCell(td,false)}}catch(d){}j.activeTable=null};j.selectedCells=function(){if(!j.activeTable)return[];try{for(var c=j.activeTable,b,d=[],a=c.rows.length-1;a>=0;a--)for(b=c.rows[a].cells.length-1;b>=0;b--)c.rows[a].cells[b].isSelected&&d.push(c.rows[a].cells[b])}catch(e){}return d};j._selectCell=function(a,b){if(a.isSelected==b)return;a.className=b?"selectedTD":"";a.isSelected=b};j._pos=function(d){var e=0,f=0,g=d.getBoundingClientRect(),c=j._getDoc(),b=j._editorObj().contentWindow,a=c.compatMode!="CSS1Compat"?c.body:c.documentElement;e=g.left-a.clientLeft+(b.scrollX?b.scrollX:a.scrollLeft);f=g.top-a.clientTop+(b.scrollY?b.scrollY:a.scrollTop);return{x:e,y:f,left:e,top:f,width:d.offsetWidth,height:d.offsetHeight}};j._startSelectTd=function(c){var u,v,l,m,h,t,s,r,g,d,i=false,b=j._getDoc(),f=b.parentWindow,k=b.compatMode!="CSS1Compat"?b.body:b.documentElement,p=b.onmousemove,q=b.onmouseup,o=b.ondragstart,n=a.onmouseup;c=j._realEvent(c);if(c.ctrlKey||c.altKey||c.button!=e?1:0)return;j.unselectAllCells();d=e?c.srcElement:c.target;while(d&&d.nodeName!="BODY"&&d.nodeName!="TD")d=d.parentNode;if(!d||d.nodeName!=="TD")return;h=d.parentNode.parentNode.parentNode;if(h.nodeName!=="TABLE")return;g=j._pos(d);l=e?c.clientX+(f.scrollX?f.scrollX:k.scrollLeft):c.pageX;m=e?c.clientY+(f.scrollY?f.scrollY:k.scrollTop):c.pageY;b.onmousemove=function(d){var b,c,v,w,o,p,r,s,t,u,a,q,n;if(e){d=this.parentWindow.event;b=d.clientX+(f.scrollX?f.scrollX:k.scrollLeft);c=d.clientY+(f.scrollY?f.scrollY:k.scrollTop)}else{b=d.pageX;c=d.pageY}if(!i&&(b<g.x||b>g.x+g.width||c<g.y||c>g.y+g.height)){i=true;j.activeTable=h}if(!i)return;n=j._getSelection();if(n.empty)n.empty();else n.removeAllRanges&&n.removeAllRanges();r=Math.min(l,b);s=Math.max(l,b);t=Math.min(m,c);u=Math.max(m,c);for(o=h.rows.length-1;o>=0;o--)for(p=h.rows[o].cells.length-1;p>=0;p--){q=h.rows[o].cells[p];a=j._pos(q);j._selectCell(q,a.x<=s&&a.y<=u&&a.x+a.width>=r&&a.y+a.height>t)}};b.ondragstart=b.onmouseup=a.onmouseup=function(){b.onmousemove=p;b.ondragstart=o,a.onmouseup=n;i=false}};j.canMergeSelectedCells=function(){if(!j.activeTable)return false;var e=j.activeTable,a,f,g,i,h,d,l,c,k=0,b=j.selectedCells();if(b.length<2)return false;TQE.updateCellsStatus(e);g=b[0].colStart;h=b[0].colEnd;i=b[0].rowStart;d=b[0].rowEnd;for(a=b.length-1;a>0;a--){g=Math.min(g,b[a].colStart);i=Math.min(i,b[a].rowStart);h=Math.max(h,b[a].colEnd);d=Math.max(d,b[a].rowEnd)}for(a=Math.min(d,e.rows.length-1);a>=0;a--)for(f=e.rows[a].cells.length-1;f>=0;f--){c=e.rows[a].cells[f];if(!c.isSelected&&c.colStart<=h&&c.colEnd>=g&&c.rowStart<=d&&c.rowEnd>=i)return false}return true};j.mergeSelectedCells=function(){if(!j.canMergeSelectedCells())return false;for(var f=j.activeTable,d,i,l,a,k="",e=null,h=1,g=1,b,c=0;c<f.rows.length;c++)for(d=0;d<f.rows[c].cells.length;d++)if(f.rows[c].cells[d].isSelected){b=f.rows[c].cells[d];k+=b.innerHTML;a=TQE.pos(b);if(e===null){e=b;i=a.x;l=a.y;h=e.rowSpan;g=e.colSpan}else{if(a.y===l)g+=b.colSpan;else if(a.x===i)h+=b.rowSpan;b.innerHTML=""}}e.innerHTML=k.replace(/(&nbsp;|<br\s*\/?>)+$/,"$1");e.rowSpan=h;e.colSpan=g;for(c=f.rows.length-1;c>=0;c--){a=f.rows[c];for(d=a.cells.length-1;d>=0;d--)if(a.cells[d].isSelected){b=a.cells[d];b!=e&&a.removeChild(b)}a.cells.length<1&&f.deleteRow(c)}TQE.updateCellsStatus(f)};j.splitCell=function(a){if(!a||a.rowSpan<2&&a.colSpan<2)return true;var g=a.parentNode.parentNode.parentNode,b,c,f,d,e;TQE.updateCellsStatus(g);for(b=a.rowStart;b<=a.rowEnd;b++){d=g.rows[b];for(c=0;c<d.cells.length;c++)if(d.cells[c].colStart>a.colEnd)break;f=a.colSpan;if(b==a.rowStart)f--;while(0<f--){e=d.insertCell(c);j._selectCell(e,a.isSelected);e.style.backgroundColor=a.style.backgroundColor}}a.rowSpan=1;a.colSpan=1};j._changed=function(){j._autoSave(1);j._showTableContext(false);var a;if("visual"===j.currentMode()){j._keepBookmark();j._hook();a=j._editorObj().contentWindow;TQE.addListener(a,"resize",j._popTableContext);if(g)a=a.document.body}else{a=j._editorObj();TQE.addListener(a,"mouseup",TQE.hidePop);a.onkeydown=function(a){return j._call("keydown",a)};a.onkeyup=function(a){return j._call("keyup",a)}}a.onfocus=function(a){j.hasFocus=true;j.obj.onfocus&&j.obj.onfocus();j._call("focus",a)};a.onblur=function(a){j.hasFocus=false;j.obj.onblur&&j.obj.onblur();j._call("blur",a)}};j._realEvent=function(a){if(e)a="code"===j.currentMode()?b.event:j._editorObj().contentWindow.event;return a};j._call=function(b,c){var a=j.config["on"+b];if("function"===typeof a)return a.call(j,j._realEvent(c))};j.changeMode=function(b){var d=j.currentMode();if(d===b)return;if(!b)b="code"!=d?"code":"visual";if(b==d)return;j.hasFocus=false;var h=j._editorObj(),e=h.offsetHeight,c,f="visual"===b;if("code"===b){j.unselectAllCells();e-=4;c='<table width=100% border=0 cellpadding=0 cellspacing=0><tr><td width=2 style="padding:0"></td><td style="padding:0"><textarea id="'+j.objId+'_Editor" wrap="hard" style="height:'+e+'px"></textarea></td></tr></table>'}else if(f)c='<IFRAME id="'+j.objId+'_Editor" frameborder=0 marginheight=0 marginwidth=0 style="height:'+e+'px" ></IFRAME>';else return;j._autoSave(0);TQE._hideContext();var g=j.content();a.body.appendChild(j._clientDiv);j._clientDiv.innerHTML=c;j._containerDiv.insertBefore(j._clientDiv,j._containerDiv.lastChild);j._initContent(g);j._updateToolbar(f,["toolbarmode","mode","fullscreen","help"],true)};j.typeset=function(){if("visual"!=j.currentMode())return;j._showTableContext(0);var f=j._getDoc(),a,b,g,e,d,k;g=f.body.innerHTML;g=g.replace(/&nbsp;/gi," ").replace(/>\s+</gm,"> <").replace(/ +/gi," ").replace(/<div/gi,"<p").replace(/<\/div/gi,"</p");f.body.innerHTML=g;b=TQE._tags(f,"CENTER");for(i=b.length-1;i>=0;i--)TQE.removeNode(b[i],false);b=TQE._tags(f,"SPAN");for(i=b.length-1;i>=0;i--){a=b[i];k=a.style.fontWeight,c=a.style.color;if(""===a.innerHTML.replace(/<[a-z\/][^>]*>/gi,"")||k==""&&c==""){TQE.removeNode(a,false);continue}a.removeAttribute("style");a.className="";a.removeAttribute("class");a.style.fontWeight=k;a.style.color=c}b=TQE._tags(f,"H3");for(i=b.length-1;i>=0;i--)if(b[i].className==="splitPage")b[i].innerHTML=b[i].innerHTML.replace(/<\/?[a-zA-z][^>]*>/g,"");b=TQE._tags(f,"P");var m=/^(&nbsp;| ){3,}/;for(i=b.length-1;i>=0;i--){a=b[i];if(""==a.innerHTML.replace(/<[a-z\/][^>]*>/gi,"").replace(/( |\n|\r|\t|&nbsp;)/gi,"")){TQE.removeNode(a,false);continue}a.removeAttribute("style");a.className="";a.removeAttribute("class");if(m.test(a.innerHTML))a.align="center";else{a.removeAttribute("align");a.style.textIndent=j.config.typesetIndentParagraph?"2em":""}}b=TQE._tags(f,"A");for(i=b.length-1;i>=0;i--){a=b[i];if(""==a.innerHTML.replace(/<[a-z\/][^>]*>/gi,"").replace(/( |\n|\r|\t|&nbsp;)/gi,"")){TQE.removeNode(a,false);continue}a.removeAttribute("style");a.className="";a.removeAttribute("class")}var l=function(a){var b=a.nodeName,c=/^( |\n|\r|\t|&nbsp;)*$/gi;return b==="#text"?c.test(a.nodeValue):"BR"===b||"IMG"!==b&&""==a.innerHTML.replace(/<[a-z\/][^>]*>/gi,"").replace(/(\s|&nbsp;)/gmi,"")},h=function(b){var a,c;while(b&&b.tagName!="BODY"){a=b;while(a=a.nextSibling){if(l(a))continue;if(a.nodeName==="#text"){e=TQE.CE("CENTER","",a.nodeValue);b.parentNode.insertBefore(e,a);TQE.removeNode(a,true);return}else{if(a.tagName=="CENTER")return;if(a.tagName=="P")a.align="center";else a.style.textAlign="center";return}}b=b.parentNode}};b=TQE._tags(f,"IMG");for(i=b.length-1;i>=0;i--){a=b[i];if(a.getAttribute("emot"))continue;j.config.typesetImageTextCenter&&h(a);a.removeAttribute("style");a.border=j.config.typesetImageBorder?"1":"0";a.style.margin="5px";d=a.parentNode;if(d.tagName=="A"&&d.firstChild==d.lastChild){a=d;d=d.parentNode}if(d.tagName=="P"&&d.align=="center"||d.tagName=="CENTER"||d.style.textAlign=="center")continue;e=TQE.CE("CENTER");d.insertBefore(e,a);e.appendChild(a)}b=TQE._tags(f,"OBJECT");for(i=b.length-1;i>=0;i--){a=b[i];j.config.typesetImageTextCenter&&h(a);d=a.parentNode;if(d.tagName=="P"&&d.align=="center"||d.tagName=="CENTER"||d.style.textAlign=="center")continue;e=TQE.CE("CENTER");d.insertBefore(e,a);e.appendChild(a)}b=TQE._tags(f,"EMBED");for(i=b.length-1;i>=0;i--){a=b[i];if("OBJECT"===a.parentNode.tagName)continue;j.config.typesetImageTextCenter&&h(a);d=a.parentNode;if(d.tagName=="P"&&d.align=="center"||d.tagName=="CENTER"||d.style.textAlign=="center")continue;e=TQE.CE("CENTER");d.insertBefore(e,a);e.appendChild(a)}j.cleanWord(true)};j.cleanWord=function(d){if("visual"!=j.currentMode())return;var a=j._getDoc(),b;if(!d){b=a.body.innerHTML;if(b.indexOf("mso")<0&&b.search(/[a-z]+:[a-z0-9]+="[^"]*"/ig)<0)return}var c=function(h,g){for(var c,e,b,d,f=h.length-1;f>=0;f--){e=TQE._tags(a,h[f]);for(d=e.length-1;d>=0;d--){c=e[d];c.removeAttribute("lang");b=c.getAttribute("style");if(null==b&&g){TQE.removeNode(c,false);continue}if(typeof b=="string"&&b.indexOf("mso-")>=0){b+=";";b=b.replace(/mso\-[^;]+?;/gi,"").replace(/FONT\-FAMILY[^;]+?;/gi,"").replace(/\s+/g," ").replace(/MARGIN\: 0cm 0cm 0pt/gi,"");if(""==b||" "==b){if(g){TQE.removeNode(c,false);continue}c.removeAttribute("style")}else c.setAttribute("style",b)}b=c.getAttribute("class");if(null!=b){b=b.replace(/mso[a-z\-]+\s*/gi,"");if(""==b)c.removeAttribute("class");else c.setAttribute("class",b)}}}};c(["SPAN"],true);c(["P","B","I","U","TD","TR","TABLE","DIV"],false);a.body.innerHTML=a.body.innerHTML.replace(/<o:[a-z0-9_]+[^>]*>/gi,"").replace(/<\/o:[a-z0-9_]+>/gi,"").replace(/<\?xml.+?\/>/gi,"").replace(/(<[a-z]+[^>]+>)/ig,function(b,a){if(a.indexOf(":")>0)a=a.replace(/[a-z]+:[a-z0-9]+="[^"]*"/ig,"");return a});j.save()};j.setWidth=function(a){if(a>1)j.config.width=a+"px";else j.config.width=a*100+"%";j._containerDiv.style.width=j.config.width};j.setHeight=function(a){if(a<9)a=9;j.config.height=a;j._setHeight(a)};j._setHeight=function(a){if(a<2)a=2;j._editorObj().style.height=a+"px";if("visual"==j.currentMode()){a-=6;if(a<2)a=2;j._getDoc().body.style.minHeight=a+"px";if(g)j._getDoc().body.style.height=a+"px"}};j._fixFull=function(){var b=TQE._doc(),a=j._containerDiv,c;a.style.zIndex="10000";a.style.width=b.clientWidth-2+"px";a.style.top=TQE._docST()+"px";a.style.left=TQE._docSL()+"px";c=b.clientHeight-j._toolbarDiv.offsetHeight;j._setHeight(c-("visual"==j.currentMode()?2:6))};j._button=function(c){for(var b=TQE._tags(j._toolbarDiv,"A"),a=b.length-1;a>=0;a--)if(c==b[a].getAttribute("name"))return b[a];return null};j.changeToolbarMode=function(k,l){var b=j._toolbarDiv,d,c,n=b.offsetHeight;if(k===f||null===k)k=b.className=="eToolBar"?true:false;else if(l===f||!l)if(k==(b.className!="eToolBar"))return;if(k){b.className="eToolBar eLargeIcons";a.body.appendChild(b);b.innerHTML=j._toobarCode(j.config.advToolbar,j.config.advToolbarRight);j._containerDiv.insertBefore(b,j._containerDiv.firstChild)}else{b.className="eToolBar";a.body.appendChild(b);b.innerHTML=j._toobarCode(j.config.toolbar,j.config.toolbarRight);j._containerDiv.insertBefore(b,j._containerDiv.firstChild)}if(e&&!m){var h=TQE._tags(b,"SPAN"),i=0,g=0;for(c=h.length-1;c>=0;c--){h[c].style.width=h[c].offsetWidth+2+"px";d=TQE._tags(h[c],"A");i=0;for(g=d.length-1;g>=0;g--)if(d[g].offsetLeft+d[g].offsetWidth>i)i=d[g].offsetLeft+d[g].offsetWidth;i-=h[c].offsetLeft-2;if(i>0)h[c].style.width=i+"px"}}if(n){j.setHeight(j.config.height+n-b.offsetHeight);j._containerDiv.style.position=="absolute"&&j._fixFull()}TQE._noSel(b);d=TQE._tags(b,"A");for(c=d.length-1;c>=0;c--){TQE.addListener(d[c],"click",j._toolbarBottonClick);TQE.addListener(d[c],"mouseout",function(){var a=TQE.activePop;this.className=a&&a.relateObj==this?"eButtonDropDown":"eButton"})}j._updateToolbar("visual"===j.currentMode(),["toolbarmode","mode","fullscreen","help"],true)};j.fullScreen=function(d){var c=j._containerDiv,e="visual"===j.currentMode(),h,g;if(d===f||null===d)d=c.style.position!="absolute";else if(d==(c.style.position=="absolute"))return;e&&j.changeMode("code");if(d){a.body.parentNode.style.overflow="hidden";a.body.appendChild(c);if(e)if(isGecko)b.setTimeout(function(){j.changeMode("visual")},1);else j.changeMode("visual");c.style.position="absolute";c.style.top="0px";j._fixFull();TQE.addListener(b,"resize",j._fixFull)}else{a.body.parentNode.style.overflow="auto";TQE.delListener(b,"resize",j._fixFull);c.style.position="";c.style.width=j.config.width;h=j._editorObj();h.style.height=j.config.height+"px";j.obj.parentNode.insertBefore(c,j.obj);e&&j.changeMode("visual");c.scrollIntoView(false)}g=j._button("fullscreen");if(g)g.id=d?"eBTNfullscreen-reset":"eBTNfullscreen"};j.setContent=function(a){if("code"===j.currentMode())j._editorObj().value=a;else{if("function"===typeof j.config.onsetcontent)a=j.config.onsetcontent.call(j,a);j._getDoc().body.innerHTML=a}j.save()};j._initContent=function(b){if("code"!==j.currentMode()){if((isGecko||isOpera)&&"<br>"==b.substring(0,4))b=b.substr(4);if(isGecko)b=b.replace(/<td([^>]*)>\s*<\/td/ig,"<td$1 ><br></td");var a=g?"":"<!DOCTYPE html>",c=j._getDoc(),d;a+="<html><head><style>\nbody{border:none;height:100%;margin:0;padding:2px;overflow:auto;";if(j.config.bgColor||j.config.textColor){if(j.config.bgColor)a+="background-color:"+j.config.bgColor+";";if(j.config.textColor)a+="color:"+j.config.textColor+";"}a+='}\nimg{cursor:default;}\n.selectedTD{background:#3399ff !important;}\n.splitPage{display:block;width:98%;!important;border-top:#999 1px solid;border-bottom:#999 1px solid;background:#FFFFFF; color:#000000;font-weight:bold;text-align:center;margin:30px auto 5;padding-top:30px;clear:both;}\n.splitPage:before{content:"'+resStrPageTitlePre+'";}';if(j.config.cssCode)a+=j.config.cssCode;a+="</style>\n";if(j.config.baseHref!="")a+='<base href="'+j.config.baseHref+'" />';if(j.config.css)a+='<link href="'+j.config.css+'" rel="stylesheet" type="text/css">\n';a+='</head><body contenteditable="true" ></body></html>';c.open();c.write(a);c.close();d=Math.max(20,j._editorObj().offsetHeight-6);if(c.body){c.body.style.minHeight=d+"px";if(g)c.body.style.height=d+"px"}}j.setContent(b);j._changed()};j.setOpacity=function(b,a){if(e)b.style.filter=a==100?"":"gray() alpha(opacity="+a+")";else b.style.opacity=a==100?"":a/100};j.inArray=function(c,b){for(var a=b.length-1;a>=0;a--)if(c==b[a])return true;return false};j.content=function(){var d=j.currentMode(),c,b,a;if("visual"===d){c=j.selectedCells();for(b=c.length-1;b>=0;b--)c[b].className="";a=j._getDoc().body.innerHTML;for(b=c.length-1;b>=0;b--)c[b].className="selectedTD";if((isGecko||isOpera)&&"<br>"==a.substring(0,4))a=a.substr(4);if(""==a.replace(/<\/?(div|p|font|b|s|u|i|strong|em|strike)(?![a-z0-9])[^>]*>|&nbsp;|\s/ig,""))a="";if("function"===typeof j.config.ongetcontent)a=j.config.ongetcontent.call(j,a);else a=TQE.formatHTML(a)}else a=j._editorObj().value;return a};j._autoSave=function(c){var b=j._editorObj(),a=c?TQE.addListener:TQE.delListener;if(e)a(b,"beforedeactivate",j.save);else if("code"==j.currentMode())a(b,"blur",j.save);else a(b.contentWindow,"blur",j.save)};j.save=function(){j.obj.value=j.content()};j._intEdit=function(a){if(a.isIniEdit)return;a.isIniEdit=true;a.style.imeMode="disabled";a.onkeypress=function(){if(45==event.keyCode){this.value="-"==this.value.charAt(0)?this.value.substr(1):"-"+this.value;return false}return event.keyCode>=48&&event.keyCode<=57};a.onpaste=function(){return!clipboardData.getData("text").match(/\D/)};a.ondragenter=function(){return!/\D/.test(event.dataTransfer.getData("text"))};a.oldBlur=a.onblur;a.onblur=function(){if(""==this.value)return;this.value=parseInt(this.value,10);var a=this.getAttribute("max"),b=this.getAttribute("min");if(a!==f&&parseInt(this.value,10)>parseInt(a,10))this.value=parseInt(a,10);if(b!=f&&parseInt(this.value,10)<parseInt(b,10))this.value=parseInt(b,10);this.oldBlur&&this.oldBlur()}};if(g||e&&(a.documentMode==7||a.compatMode!="CSS1Compat")){var o=function(a){var b=null;while(a){if(a.tagName=="TABLE")b=a;a=a.parentNode}return b},s=o(a.scripts(a.scripts.length-1));if(s&&o(TQE.find(q))===s)b.setTimeout(j.init,20);else j.init()}else j.init()};TQE.url="./";TQE.version=r;if(TQE.url==="./"){var o=a.scripts||a.getElementsByTagName("SCRIPT"),k=o[o.length-1].getAttribute("src"),n=/[\?&]skin=([a-z0-9_A-Z]+)/.exec(k),j=b.location,q=j.protocol+"//"+j.host+(j.port?":"+j.port:"")+"/",s="";k=k.split("?")[0];TQE.url=k.substring(0,k.lastIndexOf("/"));if(""==TQE.url)TQE.url="./";else TQE.url+="/";if(TQE.url.indexOf(q)===0)TQE.url=TQE.url.substring(q.length-1,TQE.url.length);a.write('<link href="'+TQE.url+(n?"skin/"+n[1]+"/":"")+'TQEditor.css" id="TQEditorSkinCSS" rel="stylesheet" type="text/css" onload="TQE.checkSkin(this)" />');e&&a.compatMode!="CSS1Compat"&&a.write('<link href="'+TQE.url+'QuirksMode.css" id="TQEditorQuirksMode" rel="stylesheet" type="text/css" onload="TQE.checkSkin(this)" />')}TQE.config={paragraphs:[["\u6b63\u6587","p"],["\u6807\u98981","h1"],["\u6807\u98982","h2"],["\u6807\u98983","h3"],["\u6807\u98984","h4"],["\u6807\u98985","h5"],["\u6807\u98986","h6"],["\u9884\u5b9a\u4e49","pre"]],fontnames:[["\u5b8b\u4f53","\u5b8b\u4f53"],["\u65b0\u5b8b\u4f53","\u65b0\u5b8b\u4f53"],["\u4eff\u5b8b_GB2312","\u4eff\u5b8b_GB2312"],["\u9ed1\u4f53","\u9ed1\u4f53"],["\u5fae\u8f6f\u96c5\u9ed1","\u5fae\u8f6f\u96c5\u9ed1"],["\u6977\u4f53_GB2312","\u6977\u4f53_GB2312"],["Arial","arial, helvetica, sans-serif"],["Courier New","courier new, courier, mono"],["Georgia","Georgia, Times New Roman, Times, Serif"],["Tahoma","Tahoma, Arial, Helvetica, sans-serif"],["Times New Roman","times new roman, times, serif"]],fontsizes:[["\u7279\u5c0f","xx-small",1],["\u8f83\u5c0f","x-small",2],["\u5c0f","small",3],["\u4e2d","medium",4],["\u5927","large",5],["\u8f83\u5927","x-large",6],["\u7279\u5927","xx-large",7]],toolbar:"default",toolbarRight:[],advToolbar:["paragraph","fontname","fontsize","br","bold","italic","underline","strikethrough","forecolor","backcolor","removeformat","typeset","||","justifyleft","justifycenter","justifyright","justifynone",["superscript","subscript"],"br","orderedlist","unorderedlist","indent","outdent","||","inserthorizontalrule","splitpage","cleanword","br","createlink","unlink","inserttable","||","insertface","insertimage","insertmusic","insertflash","insertvideo"],advToolbarRight:["toolbarmode","br","fullscreen","mode","help"],advToolbarMode:false,showToolbarGroupHandle:true,tplFlash:'<embed  src="{$url}" width="{$width}" height="{$height}" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always"></embed>',tplFlv:'<embed src="'+TQE.url+'flvPlayer.swf" flashvars="vcastr_file={$url}&IsAutoPlay={$auto_start}" width="{$width}" height="{$height}" quality="high" bgcolor="#0E0E0E" name="play" align="middle" allowscriptaccess="sameDomain" allowfullscreen="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" wmode="opaque" />',tplRm:'<embed  src="{$url}" width={$width} height={$height} autostart="{$auto_start}"type="audio/x-pn-realaudio-plugin" console="Clip1" controls="ImageWindow" ></embed>',tplVideo:'<object classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"  type="application/x-ms-wmp" width="{$width}" height="{$height}"><PARAM NAME="URL" VALUE="{$url}" /><PARAM NAME="autoStart" VALUE="{$auto_start}" /><PARAM NAME="invokeURLs" VALUE="false"><PARAM NAME="playCount" VALUE="100"><PARAM NAME="Volume" VALUE="100"><PARAM NAME="defaultFrame" VALUE="datawindow"></object>',tplMusic:'<object id="tqeMP"  classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"  type="application/x-ms-wmp" width="230" height="64"><PARAM NAME="URL" VALUE="{$url}" /><PARAM NAME="autoStart" VALUE="{$auto_start}" /><PARAM NAME="invokeURLs" VALUE="false"><PARAM NAME="playCount" VALUE="100"><PARAM NAME="Volume" VALUE="100"><PARAM NAME="defaultFrame" VALUE="datawindow"></object>',tplSplitPage:'<h3 class="splitPage" name="split_page"></h3>',uploadFieldName:"file",imageUploadUrl:"",imageFileTypes:"*.jpg;*.gif;*.png;*.jpeg",imageFileSize:"2MB",directInsertUploadImage:false,linkUploadUrl:"",linkFileTypes:"*.*",linkFileSize:"2MB",flashUploadUrl:"",flashFileTypes:"*.swf",flashFileSize:"2MB",musicUploadUrl:"",musicFileTypes:"*.mp3;*.wma",musicFileSize:"2MB",videoUploadUrl:"",videoFileTypes:"*.flv;.mp4;*.mkv;*.wmv;*.asf;*.avi;*.rmvb;*.rm",videoFileSize:"2MB",enter2br:false,width:"auto",height:"auto",autoClean:true,faceCount:55,css:"",cssCode:"",bgColor:"",textColor:"",autoPopImagePanel:true,autoPopTablePanel:true,typesetImageTextCenter:true,typesetIndentParagraph:false,typesetImageBorder:true,baseHref:"",resize:true,onfocus:null,onblur:null,onkeydown:null,onkeyup:null,onpaste:null,oninit:null,ongetcontent:null,onsetcontent:null,debug:false};TQE.find=function(b){return a.getElementById(b)};TQE.CE=function(f,d,c,e){var b=a.createElement(f);if(d)b.id=d;if(c)b.innerHTML=c;e&&a.body.appendChild(b);return b};TQE.loadSkin=function(a){var b=TQE.find("TQEditorSkinCSS");b.href=TQE.url+(a&&"default"!=a?"skin/"+a+"/":"")+"TQEditor.css"};TQE.checkSkin=function(d){for(var c=a.styleSheets,e,b=c.length-1;b>=0;b--)if(c[b].href==d.href){e=c[b].cssRules||c[b].rules;if(e.length<1)d.href=TQE.url+"TQEditor.css";break}};TQE._doc=function(){return a.compatMode!="CSS1Compat"?a.body:a.documentElement};TQE._docST=function(){return b.scrollY?b.scrollY:TQE._doc().scrollTop};TQE._docSL=function(){return b.scrollX?b.scrollX:TQE._doc().scrollLeft};TQE.pos=function(a){var b=0,c=0,d=a.getBoundingClientRect(),e=TQE._doc();b=d.left+TQE._docSL()-e.clientLeft;c=d.top+TQE._docST()-e.clientTop;return{x:b,y:c,left:b,top:c,width:a.offsetWidth,height:a.offsetHeight}};TQE._hideContext=function(){if(TQE.activeContext){TQE.activeContext.style.display="none";TQE.activeContext=null}};TQE.pop=function(a,b){if(TQE.activePop==a){TQE.hidePop();return false}TQE._hideContext();TQE.hidePop();TQE.activePop=a;a.relateObj=b;b.className="eButtonDropDown";a.style.display="block";var d=TQE.pos(b),c=d.x,f=1+b.clientHeight+d.y,e=TQE._docSL(),g=TQE._doc().clientWidth;if(c+a.offsetWidth>e+g)c-=a.offsetWidth-b.offsetWidth;a.style.left=c+"px";a.style.top=f+"px";return true};TQE.hidePop=function(){if(!TQE.activePop)return;var a=TQE.activePop;TQE.activePop=null;a.style.display="none";if(a.relateObj&&a.relateObj.className=="eButtonDropDown")a.relateObj.className="eButton";a=TQE.find("ColorPicker");if(a)a.style.display="none"};TQE.delListener=function(a,b,c){if(a.removeEventListener)a.removeEventListener(b,c,false);else a.detachEvent("on"+b,a["e"+b+c])};TQE.addListener=function(a,c,b){if(a.addEventListener)a.addEventListener(c,b,false);else{a["fn"+b]=b;a["e"+c+b]=function(c){a["fn"+b](c)};a.attachEvent("on"+c,a["e"+c+b])}};TQE._tags=function(a,b){return a.getElementsByTagName(b)};TQE.listenTags=function(e,f,c,d){for(var b=TQE._tags(e,f),a=b.length-1;a>=0;a--)TQE.addListener(b[a],c,d)};TQE._noSel=function(d,f){var g=function(){if(e){var a=event.srcElement.tagName;return"INPUT"==a||"TEXTAREA"==a}return false};if(f)for(var h=f.split(","),b,a,c=h.length-1;c>=0;c--){b=TQE._tags(d,h[c]);for(a=b.length-1;a>=0;a--){b[a].unselectable="on";b[a].onselectstart=g}}else{d.unselectable="on";d.onselectstart=g}};TQE._colorPickerUI=function(){var c=["00","33","66","99","CC","FF"],g=["FF0000","00FF00","0000FF","FFFF00","00FFFF","FF00FF"],h=191,a='<table width="'+h+'" cellpadding=0 ',d,b,f;a+=e?'cellspacing=1 border=0 bgcolor="#000000;">':'cellspacing=0 border=1 style="border-collapse:collapse;" >';for(d=0;d<2;d++)for(b=0;b<6;b++){a+="<tr height=10>";if(d>0)a+='<td bgcolor="#'+g[b]+'" name="'+name+'" style="width:10px;height:10px;border:1px inset #999;"></td>';else a+='<td bgcolor="#'+c[b]+c[b]+c[b]+'" style="width:10px;height:10px;border:1px inset #999;" ></td>';for(f=0;f<3;f++)for(j=0;j<6;j++)a+='<td bgcolor="#'+c[f+d*3]+c[j]+c[b]+'" style="width:10px;height:10px;border:1px inset #999;" ></td>';a+="</tr>"}a+='</table><div style="padding:2px 2px 1px 2px;line-height:25px;"><div style="height:25px;width:60px;display:block;float:left; margin-right:5px;" name=colorPreview></div><span name="colorValue" style="width:50px; display:inline-block;"></span><input type="button" value="'+resStrNoColor+'" /></div>';return a};TQE.pickColor=function(e,g,h){var c=TQE.find("ColorPicker");if(null==c){c=TQE.CE("DIV","ColorPicker",TQE._colorPickerUI(),true);c.className="ePopPanel";c.style.zIndex=99999999;c.onmouseover=function(){this.active=true};c.onmouseout=function(){this.active=false};TQE._noSel(c);TQE.listenTags(c,"TD","mouseover",function(){var a=this,c=this.parentNode.parentNode.parentNode.parentNode.lastChild,d=b.setInterval(function(){a.style.backgroundColor=a.style.backgroundColor!=""?"":"#FFFFFF"},500);c.firstChild.style.backgroundColor=this.bgColor;c.firstChild.nextSibling.innerHTML=this.bgColor;a.style.backgroundColor="#FFFFFF";a.onmouseout=function(){b.clearInterval(d);this.style.backgroundColor=""}});c.lastChild.lastChild.onclick=function(){this.parentNode.parentNode.style.display="none"};TQE.listenTags(c,"TD","mouseup",function(){this.parentNode.parentNode.parentNode.parentNode.style.display="none"});TQE.addListener(a,"mousedown",function(){var a=TQE.find("ColorPicker");if(!a.active)a.style.display="none"})}for(var f=TQE._tags(c,"TD"),d=f.length-1;d>=0;d--)f[d].onmousedown=function(a){e(this.bgColor);a=a||event;a.cancelBubble=true};c.lastChild.lastChild.onclick=function(a){e("");a=a||event;a.cancelBubble=true};c.style.left=g+"px";c.style.top=h+"px";c.style.display="block"};TQE.drag=function(a){a.style.position="absolute";a.style.userSelect="none";a.style.mozUserSelect="none";a.style.webkitUserSelect="none";a.dragging=false;a.onmousedown=function(c){var h,i,f,d,g=TQE.pos(this),j=TQE._docSL(),k=TQE._docST();if(e){c=b.event;f=c.srcElement;h=j+c.clientX-g.x;i=k+c.clientY-g.y}else{f=c.target;h=c.pageX-g.x;i=c.pageY-g.y}if(a.dragging)return;d=f.tagName;if(f!=this&&(d=="INPUT"||d=="TEXTAREA"||d=="BUTTON"||d=="SELECT"))return;a.dragging=true;var l=function(c){if(e){c=b.event;c.pageX=j+c.clientX;c.pageY=k+c.clientY}var d=c.pageX-h,f=c.pageY-i;a.style.left=d+"px";a.style.top=f+"px";a.style.cursor="move"},m=function(){a.style.cursor="";a.dragging=false};TQE._draging(l,m,a)}};TQE._draging=function(e,f,d){if(TQE._draging.running)return;if(d.setCapture)d.setCapture();else b.captureEvents&&b.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);TQE._draging.running=true;TQE._draging.mm=a.onmousemove;TQE._draging.mu=a.onmouseup;var c=TQE.CE("DIV","","",true);c.className="eDragMaskDiv";c.style.height=Math.max(a.documentElement.clientHeight,a.body.scrollHeight)+"px";a.onmousemove=e;a.onmouseup=function(e){c&&a.body.removeChild(c);c=null;a.onmousemove=TQE._draging.mm;a.onmouseup=TQE._draging.mu;if(d.releaseCapture)d.releaseCapture();else b.releaseEvents&&b.releaseEvents(Event.MOUSEMOVE|Event.MOUSEUP);TQE._draging.running=false;f(e)};return c};TQE._draging.running=null;TQE.clone=function(a){if(typeof a!="object")return a;if(a==null)return a;var b,c="[object Array]"==Object.prototype.toString.call(a)?[]:{};for(b in a)c[b]=TQE.clone(a[b]);return c};TQE.removeNode=function(a,b){if(a.removeNode)return a.removeNode(b);if(b)return a.parentNode.removeChild(a);while(a.firstChild)a.parentNode.insertBefore(a.firstChild,a);a.parentNode.removeChild(a)};TQE.updateCellsStatus=function(k){for(var e=k.rows,d,j,f,i,a,c,g,b=0;b<e.length;b++){c=0;for(a=0;a<e[b].cells.length;a++){f=e[b].cells[a];f.colStart=c;c+=f.colSpan;f.colEnd=c-1;f.rowStart=b;f.rowEnd=b+f.rowSpan-1}}for(b=0;b<e.length;b++){d=e[b].cells;for(a=0;a<d.length;a++){if(d[a].rowSpan<2)continue;for(c=1;c<d[a].rowSpan;c++){if(!e[b+c])break;j=e[b+c].cells;f=d[a];for(g=0;g<j.length;g++){i=j[g];if(i.colStart>=f.colStart){i.colStart+=f.colSpan;i.colEnd+=f.colSpan}}}}}for(b=e.length-1;b>=0;b--){d=e[b].cells;var h=d[0].rowSpan;for(a=d.length-1;a>0;a--){h=Math.min(h,d[a].rowSpan);if(h<2)break}if(--h>0){for(a=d.length-1;a>=0;a--){d[a].rowSpan-=h;d[a].rowEnd-=h}for(c=b-1;c>=0;c--)for(g=e[c].cells.length-1;g>=0;g--)if(e[c].cells[g].rowEnd>d[0].rowStart){e[c].cells[g].rowSpan-=h;e[c].cells[g].rowEnd-=h}}}};TQE.insertCol=function(i,k){var h=i.parentNode.parentNode.parentNode,f,d,a,g=0,e,b,c,j,l=h.rows.length;TQE.updateCellsStatus(h);b=k?i.colStart:i.colEnd+1;while(g<l){j=h.rows[g];g++;f=j.cells;d=null;for(e=Math.min(b,f.length-1);e>=0;e--){c=f[e];if(c.colStart<=b){if(c.colStart<b&&c.colEnd>=b){c.colSpan++;c.colEnd++;g+=c.rowSpan-1}else d=j.insertCell(c.colStart!=b&&(c.colEnd==b-1||e==f.length-1)?e+1:e);if(d)if(k){a=d.nextSibling;if(a&&a.rowSpan<2&&a.colStart==b)d.style.backgroundColor=a.style.backgroundColor}else{a=d.previousSibling;if(a&&a.rowSpan<2&&a.colEnd==b-1)d.style.backgroundColor=a.style.backgroundColor}break}}}};TQE.insertRow=function(g,j){var d=g.parentNode.parentNode.parentNode,b,h,f,c,a,i=0,e;TQE.updateCellsStatus(d);e=j?g.rowStart:g.rowEnd+1;for(c=Math.min(d.rows.length-1,e-1);c>=0;c--){b=d.rows[c].cells;for(a=b.length-1;a>=0;a--)if(b[a].rowEnd>=e){b[a].rowSpan++;i+=b[a].colSpan}}b=d.rows[0].cells;for(a=b.length-1;a>=0;a--)i-=b[a].colSpan;h=d.insertRow(e);while(i++<0)h.insertCell(0).innerHTML="&nbsp;";TQE.updateCellsStatus(d);b=h.cells;f=d.rows[j?e+1:e-1].cells;a=f.length-1;for(c=b.length-1;c>=0;c--){while(a>=0&&f[a].colStart>b[c].colStart)a--;if(a>=0&&f[a].colStart==b[c].colStart&&f[a].colEnd==b[c].colEnd)b[c].style.backgroundColor=f[a].style.backgroundColor}};TQE.deleteCol=function(h){var f=h.parentNode.parentNode.parentNode,e=f.rows,a,c,g,d,b;TQE.updateCellsStatus(f);d=h.colStart;b=h.colEnd;for(c=e.length-1;c>=0;c--){for(g=Math.min(b,e[c].cells.length-1);g>=0;g--){a=e[c].cells[g];if(a.colEnd>=d&&a.colStart<=b)if(a.colStart>=d&&a.colEnd<=b)e[c].removeChild(a);else if(a.colStart<d&&a.colEnd>b)a.colSpan-=1+b-d;else if(a.colStart<d&&a.colEnd>=d)a.colSpan-=a.colEnd-d+1;else if(a.colStart<=b&&a.colEnd>b){a.colSpan-=1+b-a.colStart;a.innerHTML=""}}e[c].cells.length<1&&e[c].parentNode.removeChild(e[c])}e.length<1&&f.parentNode.removeChild(f)};TQE.deleteRow=function(j){var i=j.parentNode.parentNode.parentNode,b=i.rows,g,a,f,c,k,h,e,d;TQE.updateCellsStatus(i);e=j.rowStart;d=j.rowEnd;delRowCount=j.rowSpan;g=b[d+1];for(c=Math.min(d,b.length-1);c>=0;c--){for(k=b[c].cells.length-1;k>=0;k--){a=b[c].cells[k];if(a.rowEnd>=e&&a.rowStart<=d)if(a.rowStart>=e&&a.rowEnd<=d)b[c].removeChild(a);else if(a.rowStart<e&&a.rowEnd>d)a.rowSpan-=delRowCount;else if(a.rowStart<e&&a.rowEnd>=e)a.rowSpan-=a.rowEnd-e+1;else if(a.rowStart<=d&&a.rowEnd>d){if(g){for(h=0;h<g.cells.length;h++)if(g.cells[h].colStart>a.colEnd)break;f=g.insertCell(h);f.rowSpan=a.rowSpan-delRowCount;f.colSpan=a.colSpan;f.colStart=a.colStart;f.colEnd=a.colEnd;f.style.backgroundColor=a.style.backgroundColor}b[c].removeChild(a)}}b[c].cells.length<1&&b[c].parentNode.removeChild(b[c])}b.length<1&&i.parentNode.removeChild(i)};TQE.formatHTML=function(a){return a.replace(/\s*<(p|table|tr|hr|div|object|ol|li|ul|h[1-6])(?![a-z])/ig,"\n<$1").replace(/<\/(p|table|div|object|ol|ul|h[1-6])>\s*/ig,"</$1>\n").replace(/(<(?:br|hr)(?![a-z0-9])[^>]*>)\s*/ig,"$1\n").replace(/^\s*/,"").replace(/\s*$/,"")};TQE.toolbarMode={admin:{left:["paragraph","fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","|","justifyleft","justifycenter","orderedlist","unorderedlist",["justifyright","|","indent","outdent","|","superscript","subscript"],"||","createlink","insertimage","inserttable",["splitpage","inserthorizontalrule"],"|","insertmusic","insertflash","insertvideo","||","cleanword","typeset"],right:["toolbarmode","fullscreen","|","help"]},bbs:{left:["fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","|","justifyleft","justifycenter","justifyright","||","createlink","insertimage","|","insertface","insertmusic","insertflash","insertvideo","|","typeset"],right:["toolbarmode","fullscreen","|","help"]},user:{left:["fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","|","justifyleft","justifycenter","orderedlist",["justifyright","unorderedlist","|","indent","outdent","|","inserthorizontalrule"],"||","createlink","insertimage","insertvideo","|","typeset"],right:["toolbarmode","fullscreen","|","help"]},mini:{left:["fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","|","align","|","createlink","insertimage"],right:["help"]},message:{left:["insertface","|","bold","italic","underline","forecolor","removeformat"],right:["help"]},full:{left:["paragraph","fontname","fontsize","|","bold","italic","underline","strikethrough","forecolor","backcolor","removeformat","||","align","list","iodent",["superscript","subscript"],"||","createlink","unlink","insertimage","inserttable","inserthorizontalrule","splitpage","insertface","|","insertmusic","insertflash","insertvideo","||","cleanword","typeset"],right:["toolbarmode","fullscreen","mode","|","help"]},normal:{left:["paragraph","fontsize","|","bold","italic","underline","forecolor","backcolor","removeformat","||","justifyleft","justifycenter","orderedlist","unorderedlist","||","createlink","insertimage","inserttable","|","insertvideo","|","typeset"],right:["toolbarmode","fullscreen","|","help"]}};TQE.toolbarBottons={paragraph:{text:"\u6bb5\u843d",click:function(c,i){var b=TQE.find(c.objId+"Paragraph"),a;if(null==b){var h="",d=c.config.paragraphs;for(a=0;a<d.length;a++)h+='<div name="FormatBlock" class="eMenuItem" unselectable=on onselectstart="return false" paraValue="'+d[a][1]+'">'+d[a][0]+"</div>";b=TQE.CE("DIV",c.objId+"Paragraph",h,true);b.className="ePopPanel";TQE._noSel(b);TQE.listenTags(b,"DIV","click",function(){TQE.hidePop();var a=this.getAttribute("paraValue");if(e)a="<"+a+">";c.exeCmd("FormatBlock",a)});if(g){var f=TQE._tags(b,"DIV");for(a=f.length-1;a>=0;a--)c._ieMouseStyle(f[a],"eMenuItem","eMenuItemUp","eMenuItem")}}TQE.pop(b,i)}},fontsize:{text:"\u6587\u5b57\u5927\u5c0f",click:function(c,h){var b=TQE.find(c.objId+"FontSize");if(null==b){for(var f="",e,d=c.config.fontsizes,a=0;a<d.length;a++)f+='<div name="FontSize" class="eMenuItem" unselectable=on onselectstart="return false" paraValue="'+d[a][2]+'" style="font-size:'+d[a][1]+';" >'+d[a][0]+"</div>";b=TQE.CE("DIV",c.objId+"FontSize",f,true);b.className="ePopPanel";TQE._noSel(b);TQE.listenTags(b,"DIV","click",function(){TQE.hidePop();c.exeCmd("FontSize",this.getAttribute("paraValue"))});if(g){e=TQE._tags(b,"DIV");for(a=e.length-1;a>=0;a--)c._ieMouseStyle(e[a],"eMenuItem","eMenuItemUp","eMenuItem")}}TQE.pop(b,h)}},fontname:{text:"\u5b57\u4f53",click:function(c,h){var b=TQE.find(c.objId+"FontName");if(null==b){for(var e,f="",d=c.config.fontnames,a=0;a<d.length;a++)f+='<div name="FontName" class="eMenuItem" unselectable=on onselectstart="return false"  paraValue="'+d[a][1]+'"  style="font-family:'+d[a][1]+';" >'+d[a][0]+"</div>";b=TQE.CE("DIV",c.objId+"FontName",f,true);b.className="ePopPanel";TQE._noSel(b);TQE.listenTags(b,"DIV","click",function(){TQE.hidePop();c.exeCmd("FontName",this.getAttribute("paraValue"))});if(g){e=TQE._tags(b,"DIV");for(a=e.length-1;a>=0;a--)c._ieMouseStyle(e[a],"eMenuItem","eMenuItemUp","eMenuItem")}}TQE.pop(b,h)}},forecolor:{text:"\u6587\u672c\u989c\u8272",click:function(b,a){b._showColorSelectUI(a,"forecolor")}},backcolor:{text:"\u80cc\u666f\u8272",click:function(b,a){b._showColorSelectUI(a,e?"backcolor":"hilitecolor")}},bold:{text:"\u7c97\u4f53",click:null},italic:{text:"\u659c\u4f53",click:null},underline:{text:"\u4e0b\u5212\u7ebf",click:null},strikethrough:{text:"\u5220\u9664\u7ebf",click:null},removeformat:{text:"\u6d88\u9664\u683c\u5f0f",click:function(d){TQE.hidePop();d.exeCmd("removeformat");if(isGecko||isOpera)return;var f=d._getRange(),e=function(a){return a.replace(/<\/?span[^>]*>/ig,"").replace(/<p [^>]*>/ig,"<p>").replace(/<div [^>]*>/ig,"<div>")},g="",c=f.htmlText,b,a;if(c)d.insertHtml(e(c));else{b=f.cloneContents().childNodes;for(a=0;a<b.length;a++)if("#comment"!=b[a].nodeName){c=b[a].outerHTML||b[a].nodeValue;if(c)g+=c}d.insertHtml(e(g))}}},submenu:{text:"",click:function(b,a){b._popAsMenu(a,a.getAttribute("submenu").split(","))}},subscript:{text:"\u4e0b\u6807",click:null},superscript:{text:"\u4e0a\u6807",click:null},align:{text:"\u5bf9\u9f50",click:function(b,a){b._popAsMenu(a,["justifyleft","justifycenter","justifyright"])}},justifyleft:{text:"\u5de6\u5bf9\u9f50",click:null},justifycenter:{text:"\u5c45\u4e2d\u5bf9\u9f50",click:null},justifyright:{text:"\u53f3\u5bf9\u9f50",click:null},justifyfull:{text:"\u4e24\u7aef\u5bf9\u9f50",click:null},justifynone:{text:"\u53d6\u6d88\u5bf9\u9f50",click:null},list:{text:"\u5217\u8868",click:function(b,a){b._popAsMenu(a,["orderedlist","unorderedlist"])}},unorderedlist:{text:"\u9879\u76ee\u5217\u8868",click:function(a){TQE.hidePop();a.exeCmd("InsertUnorderedList")}},orderedlist:{text:"\u6570\u76ee\u5217\u8868",click:function(a){TQE.hidePop();a.exeCmd("InsertOrderedList")}},iodent:{text:"\u7f29\u8fdb\u65b9\u5411",click:function(b,a){b._popAsMenu(a,["indent","outdent"])}},outdent:{text:"\u51cf\u5c11\u7f29\u8fdb",click:null},indent:{text:"\u589e\u52a0\u7f29\u8fdb",click:null},inserthorizontalrule:{text:"\u63d2\u5165\u6c34\u5e73\u7ebf",click:null},createlink:{text:"\u6dfb\u52a0\u94fe\u63a5",click:function(a,g){var c=TQE.find(a.objId+"CreateLink");if(null==c){var f=function(){TQE.hidePop();var f=this.form.elements,e=f.url.value,c=f.target.value,d=f.title.value,g="";if("http://"==e||""==e){a.exeCmd("Unlink");return false}var h=a._getRange();if(isWebkit&&h.collapsed||!a.exeCmd("CreateLink",e)){if(c!=="")c=' target="'+c+'" ';if(d!=="")g=' title="'+d+'" ';a.insertHtml('<a href="'+e+'" '+g+c+">"+(d?d:e)+"</a>");return false}var b=a.focusNode();do if(b.tagName=="A"){if(""==c)b.removeAttribute("target");else b.setAttribute("target",c);if(""==d)b.removeAttribute("title");else b.setAttribute("title",d);break}while(b=b.parentNode);return false};c=a._popFormUI(a.objId+"CreateLink",resStrCreateLink,resStrInsertLinkUI,f,null,a.config.linkUploadUrl,a.config.linkFileTypes,a.config.linkFileSize,"link");TQE.drag(c)}if(!TQE.pop(c,g))return;var e=TQE._tags(c,"FORM")[0],d=e.elements,b=a.focusNode();e.reset();do if(b.tagName=="A"){d.url.value=b.getAttribute("href");d.title.value=b.getAttribute("title");a.__selectOption(d.target,b.getAttribute("target"));break}while(b=b.parentNode);d.url.focus()}},unlink:{text:"\u5220\u9664\u94fe\u63a5",click:null},inserttable:{text:"\u63d2\u5165\u8868\u683c",click:function(g,s){var d=TQE.find(g.objId+"InsertTable");if(null==d){for(var n=resStrTableContextUI+'<div><table border=1 cellspacing=0 cellpadding=0 bgcolor="#FFFFFF"  bordercolor="#CCCCCC"  class="eTableInserUI"><tbody>',a=0,r=0,a=0;a<5;a++){n+="<tr>";for(r=0;r<8;r++)n+='<td width="20" height="20" ></td>';n+="</tr>"}n+='</tbody></table><div style="padding:2px 5px;">1 &times 1</div></div>';d=TQE.CE("DIV",g.objId+"InsertTable",n,true);d.className="ePopPanel";TQE._noSel(d);TQE.listenTags(d.lastChild,"TD","click",function(){TQE.hidePop();for(var b,a='<table style="border-collapse:collapse;" width=96% align=center border=1 cellspace=0 cellpadding=3 ><tbody>',c=this.parentNode.rowIndex;c>=0;c--){a+="<tr>";for(b=this.cellIndex;b>=0;b--)a+=e?'<td valign="top"></td>':'<td valign="top"><br></td>';a+="</tr>"}a+="</tbody></table>";g.insertHtml(a)});TQE.listenTags(d.lastChild,"TD","mouseover",function(){for(var b,e=this.cellIndex,a=this.parentNode,f=a.rowIndex,d=a.parentNode.parentNode,h=d.rows.length,g=a.cells.length,c=0;c<h;c++){a=d.rows[c];for(b=0;b<g;b++)a.cells[b].bgColor=c<=f&&b<=e?"#3399ff":""}d.parentNode.lastChild.innerHTML=f+1+" &times; "+(e+1)})}var c,b,k=g.selectedCells(),o=d.firstChild,p=o.firstChild,q=p.nextSibling,l=d.lastChild,m=d.lastChild.firstChild.firstChild.firstChild,t=m.cells.length,j=function(a,b){a.style.display=b?"":"none"};while(m){for(var a=0;a<t;a++)m.cells[a].bgColor="";m=m.nextSibling}l.lastChild.innerHTML="1 &times; 1";if(k.length){j(l,0);b=k[0]}else{j(l,1);b=g.focusNode();while(b&&b.nodeName!=="TD")b=b.parentNode}if(b){c=b.parentNode.parentNode.parentNode;j(o,1);j(p,g.canMergeSelectedCells());j(q,k.length<2&&(b.rowSpan>1||b.colSpan>1));j(q.nextSibling,p.style.display!="none"||q.style.display!="none")}else j(o,0);j(l.previousSibling,o.style.display!="none"&&l.style.display!="none");var i=d.firstChild.getElementsByTagName("A"),h=function(d,c){if(k.length>0)for(var a=k.length-1;a>=0;a--){k[a].align=d;k[a].vAlign=c}else if(b){b.align=d;b.vAlign=c}};for(a=i.length-1;a>=0;a--){i[a].href="#";i[a].onclick=function(){switch(this.id){case"eTableAlignDefault":c.align="";break;case"eTableAlignLeft":c.align="left";break;case"eTableAlignCenter":c.align="center";break;case"eTableAlignRight":c.align="right";break;case"eCellAlignLT":h("left","top");break;case"eCellAlignCT":h("center","top");break;case"eCellAlignRT":h("right","top");break;case"eCellAlignLC":h("left","middle");break;case"eCellAlignCC":h("center","middle");break;case"eCellAlignRC":h("right","middle");break;case"eCellAlignLB":h("left","bottom");break;case"eCellAlignCB":h("center","bottom");break;case"eCellAlignRB":h("right","bottom")}g.focus();return false}}i=d.firstChild.getElementsByTagName("INPUT");for(a=i.length-1;a>=0;a--){if(c)i[a].value=f==c[i[a].id]?"":c[i[a].id];i[a].onblur=function(){if(""==this.value)c.removeAttribute(this.id);else c[this.id]=this.value;c.style.borderCollapse=c.cellSpacing<1&&c.border==1?"collapse":""}}p.onclick=function(){TQE.hidePop();g.mergeSelectedCells();g.focus();return false};q.onclick=function(){TQE.hidePop();g.splitCell(b);g.focus();return false};if(!TQE.pop(d,s))return void 0}},insertimage:{text:"\u63d2\u5165\u56fe\u7247",click:function(c,i){var e=TQE.find(c.objId+"InsertImage");if(null==e){var h=function(){TQE.hidePop();var a=this.form.elements;c.insertImage(a.url.value,a.width.value,a.height.value,a.border.value,a.alt.value,a.align.value);return false};e=c._popFormUI(c.objId+"InsertImage",resStrInsertImage,resStrInsertImageUI,h,["width","height","border"],c.config.imageUploadUrl,c.config.imageFileTypes,c.config.imageFileSize,"image");TQE.drag(e)}if(!TQE.pop(e,i))return;var g=TQE._tags(e,"FORM")[0],d=g.elements,a=c._getRange(),b=a.commonAncestorContainer;g.reset();if(b){if(!a.collapsed&&a.startContainer==a.endContainer&&a.startOffset-a.endOffset<2&&a.startContainer.hasChildNodes())b=a.startContainer.childNodes[a.startOffset];if(b.tagName!="IMG"&&m&&""===a.toString())if(f===a.startContainer.length&&a.startContainer.firstChild===a.endContainer.previousSibling)b=a.startContainer.firstChild;else if(a.endContainer.lastChild===a.startContainer.nextSibling)b=a.endContainer.lastChild;else if(a.startContainer.length==a.startOffset&&a.endOffset==0&&a.startContainer.nextSibling==a.endContainer.previousSibling)b=a.startContainer.nextSibling;if(!b||b.tagName!="IMG")b=null}else if(a.length&&a.item(0).tagName=="IMG")b=a.item(0);if(b&&"IMG"==b.nodeName){d.url.value=b.getAttribute("src");d.width.value=b.width;d.height.value=b.height;d.border.value=b.border;d.alt.value=b.alt;c.__selectOption(d.align,b.align)}d.url.focus()}},insertface:{text:"\u8868\u60c5",click:function(c,f){var b=TQE.find(c.objId+"InsertFace");if(null==b){for(var d,e='<div class="eFace">',a=1;a<=c.config.faceCount;a++)e+='<img src="'+TQE.url+"face/"+a+'.gif" emot="'+a+'" />';e+="</div>";b=TQE.CE("DIV",c.objId+"InsertFace",e,true);b.className="ePopPanel";TQE._noSel(b);TQE.listenTags(b,"IMG","click",function(){TQE.hidePop();c.insertHtml('<img align=absMiddle src="'+this.getAttribute("src")+'" emot="'+this.getAttribute("emot")+'" />')});if(g){d=TQE._tags(b,"IMG");for(a=d.length-1;a>=0;a--)c._ieMouseStyle(d[a],"","imgHover","")}}TQE.pop(b,f)}},insertflash:{text:"\u63d2\u5165Flash",click:function(a,e){var b=TQE.find(a.objId+"InsertFlash"),c;if(null==b){var d=function(){TQE.hidePop();var b=this.form.elements;a.insertFlash(b.url.value,b.width.value,b.height.value);return false};b=a._popFormUI(a.objId+"InsertFlash",resStrInsertFlash,resStrInsertFlashUI,d,["width","height"],a.config.flashUploadUrl,a.config.flashFileTypes,a.config.flashFileSize,"flash");TQE.drag(b)}if(!TQE.pop(b,e))return;c=TQE._tags(b,"FORM")[0];c.reset();c.elements.url.focus()}},insertmusic:{text:"\u63d2\u5165\u97f3\u9891",click:function(a,e){var b=TQE.find(a.objId+"InsertMusic"),c;if(null==b){var d=function(){TQE.hidePop();var b=this.form.elements;a.insertMusic(b.url.value,b.auto_start.value);return false};b=a._popFormUI(a.objId+"InsertMusic",resStrInsertMusic,resStrInsertMusicUI,d,null,a.config.musicUploadUrl,a.config.musicFileTypes,a.config.musicFileSize,"music");TQE.drag(b)}if(!TQE.pop(b,e))return;c=TQE._tags(b,"FORM")[0];c.reset();c.elements.url.focus()}},insertvideo:{text:"\u63d2\u5165\u89c6\u9891",click:function(a,e){var b=TQE.find(a.objId+"InsertVideo"),c;if(null==b){var d=function(){TQE.hidePop();var b=this.form.elements;a.insertVideo(b.url.value,b.auto_start.value,b.width.value,b.height.value,b.video_type.value);return false};b=a._popFormUI(a.objId+"InsertVideo",resStrInsertVideo,resStrInsertVideoUI,d,["width","height"],a.config.videoUploadUrl,a.config.videoFileTypes,a.config.videoFileSize,"video");TQE.drag(b)}if(!TQE.pop(b,e))return;c=TQE._tags(b,"FORM")[0];c.reset();c.elements.url.focus()}},cleanword:{text:"\u6e05\u7406Word\u4ee3\u7801",click:function(a){TQE.hidePop();a.cleanWord(true)}},typeset:{text:"\u81ea\u52a8\u6392\u7248",click:function(a){TQE.hidePop();a.typeset()}},mode:{text:"\u67e5\u770b\u6e90\u7801",click:function(a){TQE.hidePop();a.changeMode()}},splitpage:{text:"\u63d2\u5165\u5206\u9875\u7b26",click:function(a){TQE.hidePop();a.insertHtml(a.config.tplSplitPage)}},group:{text:"",click:null},br:{text:"",click:null},separator:{text:"",click:null},fullscreen:{text:"\u5168\u5c4f",click:function(a){TQE.hidePop();a.fullScreen()}},toolbarmode:{text:"\u5de5\u5177\u680f\u6a21\u5f0f",click:function(a){TQE.hidePop();a.changeToolbarMode()}},help:{text:"\u5e2e\u52a9",click:function(b,c){var a=TQE.find(b.objId+"TQHelpPanel");if(null==a){a=TQE.CE("DIV",b.objId+"TQHelpPanel",'<form class="ePopForm" style="line-height:20px;">TQEditor<br/>'+resStrVersion+": "+r+"<br/>"+resStrSite+': <a href="http://www.e512.net" target="_blank">e512.net</a><br />'+resStrMail+': <a href="mailto:litqqs@163.com">litqqs@163.com</a><br /></form>',true);a.className="ePopPanel"}TQE.pop(a,c)}}};b.tqEditor=b.tqeditor=b.TQEditor=b.TQE=TQE;b.isIE=e;b.isIE6=g;b.isIE9=m;b.isWebkit=isWebkit;b.isOpera=isOpera;b.isGecko=isGecko})(window); 
(function(a){if(!a){throw"\u5fc5\u987b\u5148\u52a0\u8f7d TQEditor.js ";return}var b=a.prototype;b.images=function(e){var d=this,c=[],g="",f=d._getDoc(),b,a;if("code"===d.currentMode())return c;b=f.getElementsByTagName("IMG");for(a=0;a<b.length;a++)c.push(e?b[a].src:b[a].getAttribute("src"));return c};b.flashs=function(){var d=this,c=[],f="",e=d._getDoc(),b,a;if("code"===d.currentMode())return c;b=e.getElementsByTagName("EMBED");for(a=0;a<b.length;a++){if(b[a].getAttribute("type").toLowerCase().indexOf("shockwave-flash")<0||b[a].getAttribute("flashvars").toLowerCase().indexOf(".flv"))continue;c.push(full_uri?b[a].src:b[a].getAttribute("src"))}return c};b.flvs=function(){var d=this,c=[],f="",e=d._getDoc(),b,a;if("code"===d.currentMode())return c;b=e.getElementsByTagName("EMBED");for(a=0;a<b.length;a++){if(b[a].getAttribute("flashvars").toLowerCase().indexOf("vcastr_file")<0)continue;/vcastr_file=([^\"& ]+)/i.exec(b[a].getAttribute("flashvars"));RegExp.$1&&c.push(RegExp.$1)}return c};b.removeLinks=function(d){var e=this,g=e._getDoc(),c,b,f;if("code"===e.currentMode())return;c=g.getElementsByTagName("A");if("function"===typeof d)for(b=c.length-1;b>=0;b--){f=d(c[b].getAttribute("href"));f&&a.removeNode(c[b],false)}else for(b=c.length-1;b>=0;b--)a.removeNode(c[b],false);return};b.removeImages=function(d){var e=this,g=e._getDoc(),c,b,f;if("code"===e.currentMode())return;c=g.getElementsByTagName("IMG");if("function"===typeof d)for(b=c.length-1;b>=0;b--){f=d(c[b].getAttribute("src"));f&&a.removeNode(c[b],false)}else for(b=c.length-1;b>=0;b--)a.removeNode(c[b],false);return};b.removeFlashs=function(d){var e=this,g=e._getDoc(),c,b,f;if("code"===e.currentMode())return;c=g.getElementsByTagName("EMBED");if("function"===typeof d)for(b=c.length-1;b>=0;b--){f=d(c[b].getAttribute("src"));f&&a.removeNode(c[b],false)}else for(b=c.length-1;b>=0;b--)a.removeNode(c[b],false);return};b.removeObjects=function(){var d=this,e=d._getDoc(),c,b,f;if("code"===d.currentMode())return;c=e.getElementsByTagName("OBJECT");for(b=c.length-1;b>=0;b--)a.removeNode(c[b],false)};b.getSelectText=function(b){var c=this,a=c.getSelectHtml();if(b)a=a.replace(/<(br|p|div|ul|ol|li|tr)[^>]*>\n?/g,"\n");return a.replace(/<(textarea|select|script|style)[^>]*>.*?<\/\1>/ig,"").replace(/<\/?[a-z][^>]*>/ig,"").replace(/\n+/g,"\n").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ")};b.getSelectHtml=function(){var d=this;if("code"==d.currentMode()){var f=d._editorObj();if(document.selection){var k=document.selection.createRange();return k.text}return f.selectionStart!=f.selectionEnd?f.value.substring(f.selectionStart,f.selectionEnd):""}if(d.activeTable){var c,b,e,g=a.CE("DIV");g.innerHTML=d.activeTable.outerHTML;c=g.firstChild;for(b=c.rows.length-1;b>=0;b--){for(e=c.rows[b].cells.length-1;e>=0;e--)if(c.rows[b].cells[e].className=="selectedTD")c.rows[b].cells[e].className="";else c.rows[b].removeChild(c.rows[b].cells[e]);c.rows[b].cells.length<1&&c.rows[b].parentNode.removeChild(c.rows[b])}return g.innerHTML}d.focus();var i=d._getRange(),j=i.htmlText;if(j)return j;else{var g=a.CE("DIV"),h=i.cloneContents().childNodes;while(h.length)g.appendChild(h[0]);return g.innerHTML}}})(window.TQE); 
function ubb2html(g){var c=0,f=[],a=""+g,b="",e=TQE.url,d=function(a){return a.replace(/\[\]/g,function(a){return({"[":"%5b","]":"%5d"})[a]})};a=a.replace(/[<>\" ]/g,function(a){return({"<":"&lt;",">":"&gt;",'"':"&quot;"," ":"&nbsp;"})[a]}).replace(/\r?\n/g,"<br>");do b="__CODE__"+Math.random()+"_";while(a.indexOf(b)>=0);a=a.replace(/\[code[=\]].*?\[\/code\]/ig,function(a){f.push(a);return b+c+++"_"}).replace(/\[flv(?:\s*=\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+)\s*)?)?\](.*?)\[\/flv\]/ig,function(g,b,a,c,f){if(!b)b=320;if(!a)a=240;return'<embed id="flvPlayer" src="'+e+'flvPlayer.swf" flashvars="vcastr_file='+d(f)+"&IsAutoPlay="+c+'" width="'+b+'" height="'+a+'" quality="high" bgcolor="#0E0E0E" name="play" align="middle" allowscriptaccess="sameDomain" allowfullscreen="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" wmode="opaque" />'}).replace(/\[rm(?:\s*=\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+)\s*)?)?\](.*?)\[\/rm\]/ig,function(f,b,a,c,e){if(!b)b=320;if(!a)a=240;return'<embed src="'+d(e)+'" width='+b+" height="+a+' autostart="'+c+'}" type="audio/x-pn-realaudio-plugin" console="Clip1" controls="ImageWindow" ></embed>'}).replace(/\[mp3\](.*?)\[\/mp3\]/ig,'<object id="mp3Player"  classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"  type="application/x-ms-wmp" width="230" height="64"><PARAM NAME="URL" VALUE="$1" /><PARAM NAME="autoStart" VALUE="0" /><PARAM NAME="invokeURLs" VALUE="false"><PARAM NAME="playCount" VALUE="100"><PARAM NAME="Volume" VALUE="100"><PARAM NAME="defaultFrame" VALUE="datawindow"></object>').replace(/\[img\](.*?)\[\/img\]/ig,"<img src=$1 />").replace(/\[img(?:=\s*(\d+)\s*,\s*(\d+)\s*)\]\s*([\w_\-\.\/:]*)\s*\[\/img\]/ig,"<img src=$3 width=$1  height=$2 />").replace(/\[(color|size)\s*=\s*([^\]]+)\s*\]/ig,"<font $1=$2>").replace(/\[\/(color|size)\]/ig,"</font>").replace(/\[bg\s*=\s*([^\]]+)\s*\]/ig,'<span style="background:$1">').replace(/\[\/bg]/ig,"</span>").replace(/\[(left|center|right)]/ig,'<div style="text-align:$1">').replace(/\[\/(left|center|right)]/ig,"</div>").replace(/(?:<br>|\s)?\[list\](.*?)(<br>|\s)*\[\/list\]/ig,function(b,a){return"<ul>"+a.replace(/\<br\>(\s|&nbsp;)*\[\*\]/g,"<li>")+"</ul>"}).replace(/(?:<br>|\s)?\[numlist\](.*?)(<br>|\s)*\[\/numlist\]/ig,function(b,a){return"<ol>"+a.replace(/\<br\>(\s|&nbsp;)*\[\*\]/g,"<li>")+"</ol>"}).replace(/\[\:(\d+)]/g,'<img src="'+e+'face/$1.gif" emot="$1" align="absMiddle"  >').replace(/\[(\/?(?:b|u|i|s|sup|sub|h[1-6]))\]/ig,"<$1>").replace(/\[url\]\s*(((?!")[\s\S])*?)(?:"[\s\S]*?)?\s*\[\/url\]/ig,'<a href="$1">$1</a>').replace(/\[url\s*=\s*([^\]"]+?)(?:"[^\]]*?)?\s*\]\s*([\s\S]*?)\s*\[\/url\]/ig,'<a href="$1">$2</a>').replace(/\[email\]\s*(((?!")[\s\S])+?)(?:"[\s\S]*?)?\s*\[\/email\]/ig,'<a href="mailto:$1">$1</a>').replace(/\[email\s*=\s*([^\]"]+?)(?:"[^\]]*?)?\s*\]\s*([\s\S]+?)\s*\[\/email\]/ig,'<a href="mailto:$1">$2</a>').replace(/\[qq\]\s*(\d+)\s*\[\/qq\]/ig,'<a href="tencent://message/?uin=$1">$1</a>').replace(/\[qq\s*=\s*(\d+)\s*\]\s*([\s\S]+?)\s*\[\/qq\]/ig,'<a href="tencent://message/?uin=$1">$2</a>').replace(/\[quote\]([\s\S]*?)\[\/quote\]/ig,"<blockquote>$1</blockquote>");while(/\[table\](((?!\[table)[\s\S])+?)\[\/table\]/i.test(a))a=a.replace(/\[table\](((?!\[table)[\s\S])+?)\[\/table\]/ig,function(b,a){return'<table style="border-collapse: collapse;" width=98% border="1" cellPadding="3">'+a.replace(/\[(\/?(?:tr|td|th))\]/ig,"<$1>")+"</table>"});c=-1;a=a.replace(new RegExp(b+"\\d+_","g"),function(){return f[++c]});return a}function html2ubb(h){var e=0,g=[],a=""+h,d="";do d="__CODE__"+Math.random()+"_";while(a.indexOf(d)>=0);a=a.replace(/[\r\n]/g,"").replace(/<br[^>]*>/ig,"\n");a=a.replace(/\[code[=\]].*?\[\/code\]/ig,function(a){g.push(a);return d+e+++"_"}).replace(/<embed ([^>]*)>/ig,function(h,f){var a,d,c="",e="",g="",b=f.toLowerCase();a=/width\s*=\s*\"?([^ \"]+)/i.exec(b);if(a)c="="+a[1];if(c!=""){a=/height\s*=\s*\"?([^ \"]+)/i.exec(b);if(a)e=","+a[1]}if(b.indexOf("vcastr_file")){a=/vcastr_file=([^\"&]+)/.exec(f);d=a[1];if(""!=c){a=/IsAutoPlay=(0|1)/.exec(f);if(a)g=","+a[1]}return"[flv"+c+e+g+"]"+d+"[/flv]"}if(b.indexOf("shockwave-flash")){a=/src\s*=\s*\"?([^ \"]+)/i.exec(b);d=a[1];return"[flash"+c+e+"]"+d+"[/flash]"}if(b.indexOf("realaudio-plugin")){a=/src\s*=\s*\"?([^ \"]+)/i.exec(b);d=a[1];if(""!=c){a=/autostart\s*=\s*\"?(0|1)/.exec(b);if(a)g=","+a[1]}return"[rm"+c+e+"]"+d+"[/rm]"}return""}).replace(/<object (.*?)<\/object>/ig,function(f,c){var a,d,e="",g="",h="",b=c.toLowerCase();a=/width\s*=\s*\"?([^ \"]+)/i.exec(b);if(a)e="="+a[1];if(e!=""){a=/height\s*=\s*\"?([^ \"]+)/i.exec(b);if(a)g=","+a[1]}a=/<PARAM\s+NAME\s*=\s*"?URL"?\s+VALUE\s*=\s*"?([^\"> ]+)"?/i.exec(c);d=a[1];return b.indexOf("mp3player")?"[mp3]"+d+"[/mp3]":f}).replace(/<img ([^>]+)>/ig,function(g,b){var a,e,c="",f="",h="",d=b.toLowerCase();a=/width\s*=\s*\"?([^ \"]+)/i.exec(d);if(a)c="="+a[1];if(c!=""){a=/height\s*=\s*\"?([^ \"]+)/i.exec(d);if(a)f=","+a[1]}a=/emot\s*=\s*"?(\d+)"?/i.exec(b);if(a)return"[:"+a[1]+"]";a=/src\s*=\s*"?([^\"> ]+)"?/i.exec(b);e=a[1];return"[img"+c+f+"]"+e+"[/img]"}).replace(/<ul[^>]*>/ig,"\n[list]").replace(/\s*<\/ul[^>]*>/ig,"\n[/list]").replace(/<ol[^>]*>/ig,"\n[numlist]").replace(/\s*<\/ol[^>]*>/ig,"\n[/numlist]").replace(/\s*<li[^>]*>/ig,"\n[*]").replace(/<\/li[^>]*>/ig,"").replace(/<(\/?(?:b|u|i|s|sup|sub|table|tr|td|th|h[1-6]))(?![a-z])[^>]*>/ig,"[$1]").replace(/<(\/)?(strong|em|strike|del)(?![a-z])[^>]*>/ig,function(d,a,b){var c=({strong:"b",em:"i",strike:"s",del:"s"})[b.toLowerCase()];if(a!=="/")a="";return"["+a+c+"]"}).replace(/<blockquote(?:\s+[^>]*?)?>([\s\S]+?)<\/blockquote>/ig,"[quote]$1[/quote]");var i,b,f=function(e,c,b){var a=(e*65536+c*256+b*1).toString(16),d=a.length;while(d++<6)a="0"+a;return"#"+a},c=function(b){var c="",a="";b=b.toLowerCase();if(/align\s*[=:]\s*\"?(left|center|right)/.exec(b)){c+="["+RegExp.$1+"]";a="[/"+RegExp.$1+"]"+a}if(/[^-]size\s*=\s*\"?(\d+\s*(?:px|pc|pt|em|ex|cm|mm)?)/.exec(b)){c+="[size="+RegExp.$1+"]";a="[/size]"+a}if(/[^-]color\s*[:=]\s*\"?rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/.exec(b)){c+="[color="+f(RegExp.$1,RegExp.$2,RegExp.$3)+"]";a="[/color]"+a}else if(/[^-]color\s*[:=]\s*\"?([a-z0-9#]+)/.exec(b)){c+="[color="+RegExp.$1+"]";a="[/color]"+a}if(/background(?:\-color)?\s*:\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/.exec(b)){c+="[bg="+f(RegExp.$1,RegExp.$2,RegExp.$3)+"]";a="[/bg]"+a}else if(/background(?:\-color)?\s*:\s*([a-z0-9#]+)/.exec(b)){c+="[bg="+RegExp.$1+"]";a="[/bg]"+a}return{pre:c,end:a}};while(/<div([^>]*)>(((?!<div)[\s\S])*?)<\/div>/i.test(a))a=a.replace(/<div([^>]*)>(((?!<div)[\s\S])*?)<\/div>/ig,function(e,a,d){b=c(a);return"\n"+b.pre+d+b.end+"\n"});while(/<p([^>]*)>(((?!<p)[\s\S])*?)<\/p>/i.test(a))a=a.replace(/<p([^>]*)>(((?!<p)[\s\S])*?)<\/p>/ig,function(e,a,d){b=c(a);return"\n"+b.pre+d+b.end+"\n"});while(/<span([^>]*)>(((?!<span)[\s\S])*?)<\/span>/i.test(a))a=a.replace(/<span([^>]*)>(((?!<span)[\s\S])*?)<\/span>/ig,function(e,a,d){b=c(a);return b.pre+d+b.end});while(/<font([^>]*)>(((?!<font)[\s\S])*?)<\/font>/i.test(a))a=a.replace(/<font([^>]*)>(((?!<font)[\s\S])*?)<\/font>/ig,function(e,a,d){b=c(a);return b.pre+d+b.end});e=-1;a=a.replace(/<a .*?href\s*=\s*["']?([^'" ]+)[^>]*>([\s\S]*?)<\/a>/ig,function(e,a,c){var b="url";if("mailto:"==a.substr(0,7).toLowerCase()){b="email";a=a.substr(7,a.length)}else if("tencent:"==a.substr(0,8)){b="qq";var d=/uin=(\d+)/i.exec(a);a=d[1]}return c==a?"["+b+"]"+c+"[/"+b+"]":"["+b+"="+a+"]"+c+"[/"+b+"]"}).replace(/<\/?[a-z][^>]*>/ig,"").replace(new RegExp(d+"\\d+_","g"),function(){return g[++e]}).replace(/(&nbsp;|&gt;|&lt;|&quot;)/g,function(a){return({"&nbsp;":" ","&gt;":">","&lt;":"<","&quot;":'"'})[a]}).replace(/\n\s*\n/g,"\n\n");return a}TQE.formatHTML=function(m){var d=m.replace(/<(strong|b|u|i|em|span|font)[^>]*><\/\1>/ig,""),a="",l=new RegExp("\\s*(<(\\/?)([a-z]\\w*)[^>]*>)[\\r\\n]*","im"),c=[],h={table:1,tbody:1,thead:1,tfoot:1,tr:1,td:1,p:1,caption:1,div:1,object:1,param:1,embed:1,dl:1,dd:1,dt:1,ul:1,ol:1,li:1,hr:1,script:1},f={table:1,tbody:1,thead:1,tfoot:1,tr:1,object:1,dl:1,ul:1,ol:1,div:1,script:1},i={a:1,u:1,i:1,b:1,strong:1,em:1,font:1,span:1,img:1,input:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1},k,g,e,j,b;while(null!=(result=l.exec(d))){k=d.substr(0,result.index);g=result[0];e=result[1];j="/"===result[2];b=result[3].toLowerCase();d=d.substr(result.index+g.length);a+=k;if(j){f[b]&&c.pop();if(i[b])a+=g;else if(f[b])a+="\n"+c.join("")+e;else a+=e;if(h[b])a+="\n"}else{if(h[b])a+="\n";if(i[b])a+=g;else if(f[b])a+=c.join("")+e+"\n";else a+=c.join("")+e;if("hr"===b||"br"===b)a+="\n";f[b]&&c.push("  ")}}a+=d;a=a.replace(/\n+/g,"\n").replace(/^[ \n\r\t]+/g,"").replace(/[ \n\r\t]+$/g,"").replace(/<td([^>]*)>\s+<br/ig,"<td$1 ><br").replace(/<br>\s+<\/td>/ig,"<br></td>");if("<p>&nbsp;</p>"===a||"<br>"===a)a="";return a}